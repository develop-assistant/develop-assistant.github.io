<!DOCTYPE html>
<html lang=zh>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  <meta name="google-site-verification" content="zo0LqAAU1ik3Yk5Gdqg2DpsQI1Xlhh7jC07I0IGeyVc" />
  <meta name="baidu-site-verification" content="6LE45O63Sc" />
  <!-- 谷歌广告-->
  <!--<script data-ad-client="ca-pub-6442249173079218" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>-->
  
  
  <title>编程规范 | 当我遇上你</title>
  <meta name="description" content="Java后端开发规范  Git分支管理规范  1. 分支说明及操作   master 分支  主分支，永远处于稳定状态，对应当前线上版本 以 tag 标记一个版本，因此在 master 分支上看到的每一个 tag 都应该对应一个线上版本 不允许在该分支直接提交代码    develop 分支  开发分支，包含了项目最新的功能和代码，所有开发都依赖 develop 分支进行 小的改动可以直接在 d">
<meta property="og:type" content="article">
<meta property="og:title" content="编程规范">
<meta property="og:url" content="https://idea360.cn/2021/05/01/code-format/index.html">
<meta property="og:site_name" content="当我遇上你">
<meta property="og:description" content="Java后端开发规范  Git分支管理规范  1. 分支说明及操作   master 分支  主分支，永远处于稳定状态，对应当前线上版本 以 tag 标记一个版本，因此在 master 分支上看到的每一个 tag 都应该对应一个线上版本 不允许在该分支直接提交代码    develop 分支  开发分支，包含了项目最新的功能和代码，所有开发都依赖 develop 分支进行 小的改动可以直接在 d">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-05-01T03:20:04.000Z">
<meta property="article:modified_time" content="2021-12-04T14:56:13.695Z">
<meta property="article:author" content="当我遇上你">
<meta property="article:tag" content="java">
<meta property="article:tag" content="规范">
<meta name="twitter:card" content="summary">
  <!-- Canonical links -->
  <link rel="canonical" href="https://idea360.cn/2021/05/01/code-format/index.html">
  
    <link rel="alternate" href="/atom.xml" title="当我遇上你" type="application/atom+xml">
  
  
    <link rel="icon" href="https://raw.githubusercontent.com/qidian360/oss/master/images/favicon.png" type="image/x-icon">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  
  
  
<meta name="generator" content="Hexo 5.4.0"></head>


<body class="main-center theme-white" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="https://github.com/qidian360" target="_blank">
          <img class="img-circle img-rotate" src="https://raw.githubusercontent.com/qidian360/oss/master/images/one.png" width="200" height="200">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">当我遇上你</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md"></h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Beijing, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav ">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">首页</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">归档</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">分类</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-tags">
          <a href="/tags">
            
            <i class="icon icon-tags"></i>
            
            <span class="menu-title">标签</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-about">
          <a href="/about">
            
            <i class="icon icon-cup-fill"></i>
            
            <span class="menu-title">关于</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/qidian360" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="/atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p>欢迎交流与分享经验!</p><div><img src="https://raw.githubusercontent.com/qidian360/oss/master/images/wechat-qr-code.png" width="140px" height="140px"></div>
            </div>
        </div>
    </div>
</div>

    
  </div>
</aside>

  
  
<aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <nav id="toc" class="article-toc">
      <h3 class="toc-title">文章目录</h3>
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#java%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83"><span class="toc-number">1.</span> <span class="toc-text"> Java后端开发规范</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#git%E5%88%86%E6%94%AF%E7%AE%A1%E7%90%86%E8%A7%84%E8%8C%83"><span class="toc-number">1.1.</span> <span class="toc-text"> Git分支管理规范</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%88%86%E6%94%AF%E8%AF%B4%E6%98%8E%E5%8F%8A%E6%93%8D%E4%BD%9C"><span class="toc-number">1.1.1.</span> <span class="toc-text"> 1. 分支说明及操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%8F%90%E4%BA%A4%E4%BF%A1%E6%81%AF%E8%A7%84%E8%8C%83"><span class="toc-number">1.1.2.</span> <span class="toc-text"> 2. 提交信息规范</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A1%A5%E5%85%85%E8%A7%84%E8%8C%83"><span class="toc-number">1.2.</span> <span class="toc-text"> 补充规范</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%91%BD%E5%90%8D%E8%A7%84%E8%8C%83"><span class="toc-number">1.2.1.</span> <span class="toc-text"> 服务命名规范</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%85%E5%90%8D%E5%91%BD%E5%90%8D%E8%A7%84%E8%8C%83"><span class="toc-number">1.2.2.</span> <span class="toc-text"> 包名命名规范</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#redis-key%E5%90%8D%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83"><span class="toc-number">1.2.3.</span> <span class="toc-text"> Redis Key名设计规范</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A5%E5%BF%97%E4%BD%BF%E7%94%A8%E8%A7%84%E8%8C%83"><span class="toc-number">1.2.4.</span> <span class="toc-text"> 日志使用规范</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E4%BD%BF%E7%94%A8%E6%97%A5%E5%BF%97"><span class="toc-number">1.2.4.1.</span> <span class="toc-text"> 什么时候使用日志</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%A5%E5%BF%97%E8%A7%84%E7%BA%A6%E8%A1%A5%E5%85%85"><span class="toc-number">1.2.4.2.</span> <span class="toc-text"> 日志规约补充</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E8%A7%84%E8%8C%83"><span class="toc-number">1.2.5.</span> <span class="toc-text"> 异常处理规范</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E4%BD%BF%E7%94%A8%E8%A7%84%E8%8C%83"><span class="toc-number">1.2.6.</span> <span class="toc-text"> 事务使用规范</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E9%87%8A"><span class="toc-number">1.2.7.</span> <span class="toc-text"> 注释</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B1%BB%E6%B3%A8%E9%87%8A"><span class="toc-number">1.2.7.1.</span> <span class="toc-text"> 类注释</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E6%B3%A8%E9%87%8A"><span class="toc-number">1.2.7.2.</span> <span class="toc-text"> 方法注释</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%B9%E4%BA%8E%E5%A4%9A%E4%BA%BA%E4%BF%AE%E6%94%B9%E5%90%8C%E4%B8%80%E6%96%B9%E6%B3%95-%E6%B3%A8%E9%87%8A%E4%B8%AD%E5%BA%94%E8%AF%A5%E6%A0%87%E6%98%8E%E4%BF%AE%E6%94%B9%E4%BA%BA-%E4%BF%AE%E6%94%B9%E6%97%A5%E6%9C%9F-%E4%BF%AE%E6%94%B9%E8%AF%B4%E6%98%8E"><span class="toc-number">1.2.7.3.</span> <span class="toc-text"> 对于多人修改同一方法, 注释中应该标明修改人, 修改日期, 修改说明</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sql%E8%A7%84%E8%8C%83"><span class="toc-number">1.2.8.</span> <span class="toc-text"> SQL规范</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">2.</span> <span class="toc-text"> 参考</span></a></li></ol>
    </nav>
  </div>
</aside>

<main class="main" role="main">
  <div class="content">
  <article id="post-code-format" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      编程规范
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/2021/05/01/code-format/" class="article-date">
	  <time datetime="2021-05-01T03:20:04.000Z" itemprop="datePublished">2021-05-01</time>
	</a>
</span>
        
  <span class="article-category">
    <i class="icon icon-folder"></i>
    <a class="article-category-link" href="/categories/java/">java</a>
  </span>

        
  <span class="article-tag">
    <i class="icon icon-tags"></i>
	<a class="article-tag-link-link" href="/tags/java/" rel="tag">java</a>, <a class="article-tag-link-link" href="/tags/%E8%A7%84%E8%8C%83/" rel="tag">规范</a>
  </span>


        
	<span class="article-read hidden-xs">
	    <i class="icon icon-eye-fill" aria-hidden="true"></i>
	    <span id="busuanzi_container_page_pv">
			<span id="busuanzi_value_page_pv">0</span>
		</span>
	</span>


	<span class="article-read hidden-xs">
    	<i class="icon icon-eye-fill" aria-hidden="true"></i>
    	<span id="/2021/05/01/code-format/" class="leancloud_visitors"  data-flag-title="编程规范">
			<span class="leancloud-visitors-count">0</span>
		</span>
    </span>

        <span class="post-comment"><i class="icon icon-comment"></i> <a href="/2021/05/01/code-format/#comments" class="article-comment-link">评论</a></span>
        
      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <h1 id="java后端开发规范"><a class="markdownIt-Anchor" href="#java后端开发规范"></a> Java后端开发规范</h1>
<h2 id="git分支管理规范"><a class="markdownIt-Anchor" href="#git分支管理规范"></a> Git分支管理规范</h2>
<h3 id="1-分支说明及操作"><a class="markdownIt-Anchor" href="#1-分支说明及操作"></a> 1. 分支说明及操作</h3>
<ul>
<li>
<p><strong>master 分支</strong></p>
<ul>
<li>主分支，永远处于稳定状态，对应当前线上版本</li>
<li>以 tag 标记一个版本，因此在 master 分支上看到的每一个 tag 都应该对应一个线上版本</li>
<li>不允许在该分支直接提交代码</li>
</ul>
</li>
<li>
<p><strong>develop 分支</strong></p>
<ul>
<li>开发分支，包含了项目最新的功能和代码，所有开发都依赖 develop 分支进行</li>
<li>小的改动可以直接在 develop 分支进行，改动较多时切出新的 feature 分支进行</li>
</ul>
<p><strong>注：</strong> 更好的做法是 develop 分支作为开发的主分支，也不允许直接提交代码。小改动也应该以 feature 分支提 merge request 合并，目的是保证每个改动都经过了强制代码 review，降低代码风险。</p>
</li>
<li>
<p><strong>feature 分支</strong></p>
<ul>
<li>功能分支，开发新功能的分支</li>
<li>开发新的功能或者改动较大的调整，从 develop 分支切换出 feature 分支，分支名称为 <code>feature/xxx</code></li>
<li>开发完成后合并回 develop 分支并且删除该 feature/xxx 分支</li>
</ul>
</li>
<li>
<p><strong>release 分支</strong></p>
<ul>
<li>发布分支，新功能合并到 develop 分支，准备发布新版本时使用的分支</li>
<li>当 develop 分支完成功能合并和部分 bug fix，准备发布新版本时，切出一个 release 分支，来做发布前的准备，分支名约定为<code>release/xxx</code></li>
<li>发布之前发现的 bug 就直接在这个分支上修复，确定准备发版本就合并到 master 分支，完成发布，同时合并到 develop 分支</li>
</ul>
</li>
<li>
<p><strong>hotfix 分支</strong></p>
<ul>
<li>紧急修复线上 bug 分支</li>
<li>当线上版本出现 bug 时，从 master 分支切出一个 <code>hotfix/xxx</code> 分支，完成 bug 修复，然后将 <code>hotfix/xxx</code> 合并到 master 和 develop 分支(如果此时存在 release 分支，则应该合并到 release 分支)，合并完成后删除该 <code>hotfix/xxx</code> 分支</li>
</ul>
</li>
</ul>
<p>以上就是在项目中应该出现的分支以及每个分支功能的说明。<br />
其中稳定长期存在的分支只有 master 和 develop 分支，别的分支在完成对应的使命之后都会合并到这两个分支然后被删除。简单总结如下：</p>
<ul>
<li>master 分支: 线上稳定版本分支, 该分支代码与线上代码是完全一致的。</li>
<li>develop 分支: 开发分支，衍生出 feature 分支和 release 分支</li>
<li>release 分支: 发布分支，准备待发布版本的分支，存在多个，版本发布之后删除。该分支从 develop 分支创建，创建之后由测试人员发布到测试环境进行测试。</li>
<li>feature 分支: 功能分支，完成特定功能开发的分支，存在多个，功能合并之后删除</li>
<li>hotfix 分支: 紧急热修复分支，存在多个，紧急版本发布之后删除</li>
</ul>
<h3 id="2-提交信息规范"><a class="markdownIt-Anchor" href="#2-提交信息规范"></a> 2. 提交信息规范</h3>
<p>提交信息规范部分参考 <a target="_blank" rel="noopener" href="https://github.com/angular/angular.js/blob/master/DEVELOPERS.md#commits">Angular.js commit messgae</a>。</p>
<p>git commit 格式 如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;type&gt;(&lt;scope&gt;): &lt;subject&gt;</span><br><span class="line">&lt;BLANK LINE&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;BLANK LINE&gt;</span><br><span class="line">&lt;footer&gt;</span><br></pre></td></tr></table></figure>
<p>各个部分的说明如下：</p>
<ul>
<li>
<p><strong>type 类型，提交的类别</strong></p>
<ul>
<li><strong>feat</strong>: 新功能</li>
<li><strong>fix</strong>: 修复 bug</li>
<li><strong>docs</strong>: 文档变动</li>
<li><strong>style</strong>: 格式调整，对代码实际运行没有改动，例如添加空行、格式化等</li>
<li><strong>refactor</strong>: bug 修复和添加新功能之外的代码改动</li>
<li><strong>perf</strong>: 提升性能的改动</li>
<li><strong>test</strong>: 添加或修正测试代码</li>
<li><strong>chore</strong>: 构建过程或辅助工具和库（如文档生成）的更改</li>
</ul>
</li>
<li>
<p><strong>scope 修改范围</strong></p>
<p>主要是这次修改涉及到的部分，简单概括，例如 login、train-order</p>
</li>
<li>
<p><strong>subject 修改的描述</strong></p>
<p>具体的修改描述信息</p>
</li>
<li>
<p><strong>范例</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">feat(detail): 详情页修改样式</span><br><span class="line">fix(login): 登录页面错误处理</span><br><span class="line"><span class="built_in">test</span>(list): 列表页添加测试代码</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="补充规范"><a class="markdownIt-Anchor" href="#补充规范"></a> 补充规范</h2>
<h3 id="服务命名规范"><a class="markdownIt-Anchor" href="#服务命名规范"></a> 服务命名规范</h3>
<p>采用英文小写方式</p>
<p>命名结构: 项目名-微服务名-服务类型(如pay-bill-web)</p>
<ol>
<li>项目名: 立项的项目, 如crm、call等</li>
<li>微服务名: 表示微服务的核心业务或功能</li>
<li>服务类型说明:</li>
</ol>
<ul>
<li>Dubbo: service</li>
<li>SpringBoot: web</li>
</ul>
<h3 id="包名命名规范"><a class="markdownIt-Anchor" href="#包名命名规范"></a> 包名命名规范</h3>
<table>
<thead>
<tr>
<th>命名</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>cn.idea360</td>
<td>总体要求</td>
</tr>
<tr>
<td>cn.idea360.xxx.controller</td>
<td>controller的package</td>
</tr>
<tr>
<td>cn.idea360.xxx.service</td>
<td>service的package</td>
</tr>
<tr>
<td>cn.idea360.xxx.service.impl</td>
<td>service接口实现的package</td>
</tr>
<tr>
<td>cn.idea360.xxx.dao</td>
<td>dao的package</td>
</tr>
<tr>
<td>cn.idea360.xxx.dao.impl</td>
<td>dao接口实现类的package</td>
</tr>
<tr>
<td>cn.idea360.xxx.entity</td>
<td>表实体的package</td>
</tr>
<tr>
<td>cn.idea360.xxx.vo</td>
<td>api层实体的package</td>
</tr>
<tr>
<td>cn.idea360.xxx.dto</td>
<td>数据交换的package</td>
</tr>
<tr>
<td>cn.idea360.xxx.common</td>
<td>utils、config等package</td>
</tr>
<tr>
<td>cn.idea360.xxx.api</td>
<td>dubbo接口定义package</td>
</tr>
<tr>
<td>cn.idea360.xxx.provider</td>
<td>dubbo服务提供package</td>
</tr>
</tbody>
</table>
<blockquote>
<p>方法名、参数名、成员变量、局部变量都统一使用lowerCamelCase风格, 必须遵从驼峰形式</p>
</blockquote>
<h3 id="redis-key名设计规范"><a class="markdownIt-Anchor" href="#redis-key名设计规范"></a> Redis Key名设计规范</h3>
<p>redis-key基于以下几个角度进行设计</p>
<ol>
<li>可读性和可管理性(以业务名为前缀(防止key冲突)，用冒号分隔，比如业务名:表名:id)</li>
<li>简洁性(保证语义的前提下，控制key的长度, 如cid用c, uid用u代替)</li>
<li>现在公司是saas业务, 和用户相关的数据最好包含cid和uid, 如不相关可不写</li>
<li>需要对key设置合理过期时间</li>
<li>命名必须全部小写字母、数字、英文点号(.)和英文半角冒号(:)组成，必须以英文字母开头</li>
</ol>
<p>key完整示例:</p>
<p>应用名.服务名:c:{cid}:u:{uid}:{xxx}</p>
<blockquote>
<p>应用名和服务名需要统一约定字母缩写</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 说明：</span><br><span class="line"># crm.pay    crm业务线支付服务(同一业务逻辑含义段的单词之间使用英文半角点号 (.)分割，用来表示一个完整的语义)</span><br><span class="line"># c:1        公司id为1</span><br><span class="line"># u:1        用户id为1</span><br><span class="line"># 7          业务参数, 业务参数由开发根据实际业务设计, 建议多维度描述用-标识</span><br><span class="line">crm.pay:c:1:u:1:7</span><br></pre></td></tr></table></figure>
<h3 id="日志使用规范"><a class="markdownIt-Anchor" href="#日志使用规范"></a> 日志使用规范</h3>
<p>日志优先参考阿里巴巴日志规约</p>
<h4 id="什么时候使用日志"><a class="markdownIt-Anchor" href="#什么时候使用日志"></a> 什么时候使用日志</h4>
<ul>
<li>
<p><strong>系统初始化</strong>：系统或者服务的启动参数。核心模块或者组件初始化过程中往往依赖一些关键配置，根据参数不同会提供不一样的服务。务必在这里记录 INFO 日志，打印出参数以及启动完成态服务表述。</p>
</li>
<li>
<p><strong>编程语言提示异常</strong>：如今各类主流的编程语言都包括异常机制，业务相关的流行框架有完整的异常模块。这类捕获的异常是系统告知开发人员需要加以关注的，是质量非常高的报错。应当适当记录日志，根据实际结合业务的情况使用 WARN 或者 ERROR 级别。</p>
</li>
<li>
<p><strong>业务流程预期不符</strong>：除开平台以及编程语言异常之外，项目代码中结果与期望不符时也是日志场景之一，简单来说所有流程分支都可以加入考虑。取决于开发人员判断能否容忍情形发生。常见的合适场景包括外部参数不正确，数据处理问题导致返回码不在合理范围内等等。</p>
</li>
<li>
<p><strong>系统核心角色，组件关键动作</strong>：系统中核心角色触发的业务动作是需要多加关注的，是衡量系统正常运行的重要指标，建议记录 INFO 级别日志，比如电商系统用户从登录到下单的整个流程；微服务各服务节点交互；核心数据表增删改；核心组件运行等等，如果日志频度高或者打印量特别大，可以提炼关键点 INFO 记录，其余酌情考虑 DEBUG 级别。</p>
</li>
<li>
<p><strong>第三方服务远程调用</strong>：微服务架构体系中有一个重要的点就是第三方永远不可信，对于第三方服务远程调用建议打印请求和响应的参数，方便在和各个终端定位问题，不会因为第三方服务日志的缺失变得手足无措。</p>
</li>
</ul>
<h4 id="日志规约补充"><a class="markdownIt-Anchor" href="#日志规约补充"></a> 日志规约补充</h4>
<ol>
<li>生产环境的服务需要集成ELK。kafka-topic必须以log-xxx命名, xxx为服务名</li>
<li>日志文件目录：/jesong/logs/xxx, xxx为项目名</li>
<li>日志文件命名：xxx.level.date.0.log, 其中xxx为项目名, level为日志等级, date为日志日期, 0为日志分割编号</li>
<li>日志需要做循环滚动删除配置</li>
<li>日志打印必须包含上下文</li>
<li>不允许记录日志后又抛出异常，因为这样会多次记录日志，只允许记录一次日志</li>
</ol>
<h3 id="异常处理规范"><a class="markdownIt-Anchor" href="#异常处理规范"></a> 异常处理规范</h3>
<ol>
<li>运行时异常需继承自统一异常 <code>EasyliaoException</code>, 异常通过全局异常统一返回</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.idea360<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>idea360-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol>
<li>异常的捕获用于容错处理。绝大部分场景,不允许捕获异常,不要乱加空判断。只有明显不需要关心的异常，如关闭资源的时候的io异常，可以捕获然后什么都不干,其他时候, 不允许捕获异常, 都抛出去到controller处理。空判断大部分时候不需要，你如果写了空判断，你就必须测试为空和不为空二种场景, 要么就不要写空判断。</li>
</ol>
<blockquote>
<p>强调, 有些空判断是要的，如：参数是用户输入的情况下。</p>
</blockquote>
<h3 id="事务使用规范"><a class="markdownIt-Anchor" href="#事务使用规范"></a> 事务使用规范</h3>
<ol>
<li>不得使用事务超时时间</li>
<li>只读接口不允许使用事务</li>
<li>严禁在事务中访问第三方/严禁在事务中使用分布式锁。因为只要进入了Transactional，哪怕没有任何SQL语句，都会占用数据库连接。所以，一旦在事务中访问第三方，第三方的故障可能会导致我方的数据库连接被大量占用。会产生灾难性的结果</li>
<li>事务粒度最小化</li>
</ol>
<h3 id="注释"><a class="markdownIt-Anchor" href="#注释"></a> 注释</h3>
<h4 id="类注释"><a class="markdownIt-Anchor" href="#类注释"></a> 类注释</h4>
<p>类注释必须包含作者+日期+功能描述, 如</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * 支付账单</span><br><span class="line"> * </span><br><span class="line"> * @author xxx</span><br><span class="line"> * @date 2021-01-22</span><br><span class="line"> *&#x2F;</span><br></pre></td></tr></table></figure>
<h4 id="方法注释"><a class="markdownIt-Anchor" href="#方法注释"></a> 方法注释</h4>
<p>方法注释中必须包含功能描述+入参说明+返回说明, 如</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * 创建 CuratorFramework 对象并连接 Zookeeper</span><br><span class="line"> *</span><br><span class="line"> * @param zookeeperProperties zk配置文件</span><br><span class="line"> * @return CuratorFramework zk客户端</span><br><span class="line"> *&#x2F;</span><br></pre></td></tr></table></figure>
<h4 id="对于多人修改同一方法-注释中应该标明修改人-修改日期-修改说明"><a class="markdownIt-Anchor" href="#对于多人修改同一方法-注释中应该标明修改人-修改日期-修改说明"></a> 对于多人修改同一方法, 注释中应该标明修改人, 修改日期, 修改说明</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * 创建 CuratorFramework 对象并连接 Zookeeper</span><br><span class="line"> *</span><br><span class="line"> * @param zookeeperProperties zk配置文件</span><br><span class="line"> * @return CuratorFramework zk客户端</span><br><span class="line"> *</span><br><span class="line"> * @author: xxx</span><br><span class="line"> * @date: 2021-01-22</span><br><span class="line"> * @modify: 将xxx修改为xxx</span><br><span class="line"> *&#x2F;</span><br></pre></td></tr></table></figure>
<h3 id="sql规范"><a class="markdownIt-Anchor" href="#sql规范"></a> SQL规范</h3>
<p><strong>1.使用InnoDB存储引擎</strong></p>
<p><strong>2. 字符集编码utf8mb4, 排序规则 默认采用不区分大小写的utf8mb4_general_ci, 表及字段必须添加COMMENT描述</strong></p>
<p><strong>3. 把字段定义为NOT NULL并且提供默认值</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a. null的列使索引&#x2F;索引统计&#x2F;值比较都更加复杂，对MySQL来说更难优化。</span><br><span class="line">b. null 这种类型MySQL内部需要进行特殊处理,增加数据库处理记录的复杂性,同等条件下，表中有较多空字段的时候，数据库的处理性能会降低很多。</span><br><span class="line">c. null值需要更多的存储空,无论是表还是索引中每行中的null的列都需要额外的空间来标识。</span><br><span class="line">d. 对null 的处理时候，只能采用is null或is not null，而不能采用&#x3D;、in、&lt;、&lt;&gt;、!&#x3D;、not in这些操作符号。</span><br></pre></td></tr></table></figure>
<p><strong>4. 禁止使用小数存储金额等数据, 避免精度丢失</strong></p>
<p><strong>5. 数据量大的表必须建立索引</strong></p>
<p><strong>6. 禁止在更新十分频繁、区分度不高的属性上建立索引</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a. 更新会变更B+树，更新频繁的字段建立索引会大大降低数据库性能</span><br><span class="line">b. “性别”这种区分度不大的属性，建立索引是没有什么意义的，不能有效过滤数据，性能与全表扫描类似</span><br></pre></td></tr></table></figure>
<p><strong>7. 建立组合索引, 把区分度高的字段放在前面</strong></p>
<p><strong>8. 禁止在WHERE条件的属性上使用函数或者表达式</strong></p>
<h1 id="参考"><a class="markdownIt-Anchor" href="#参考"></a> 参考</h1>
<ul>
<li><a target="_blank" rel="noopener" href="https://xwjie.github.io/rule/exception.html#%E9%94%99%E8%AF%AF%E8%8C%83%E4%BE%8B">https://xwjie.github.io/rule/exception.html#错误范例</a></li>
</ul>

      
    </div>
    <div class="article-footer">
      <!--<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-6442249173079218"
     data-ad-slot="9150075714"></ins>
<script>
    (adsbygoogle = window.adsbygoogle || []).push({});
</script>
-->
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="https://idea360.cn/2021/05/01/code-format/" title="编程规范" target="_blank" rel="external">https://idea360.cn/2021/05/01/code-format/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="https://github.com/qidian360" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="https://raw.githubusercontent.com/qidian360/oss/master/images/one.png" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="https://github.com/qidian360" target="_blank"><span class="text-dark">当我遇上你</span><small class="ml-1x"></small></a></h3>
        <div>勿在浮沙筑高楼</div>
      </div>
    </figure>
  </div>
</div>


    </div>
  </article>
  
    
  <section id="comments">
  	
      <div id="vcomments"></div>
    
  </section>


  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/2021/05/05/sdk-simple-log/" title="Jar包开发日志如何配置"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a>
    </li>
    
    
    <li class="next">
      <a href="/2021/04/24/hibernate-id-generate/" title="Hibernate主键生成策略"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
    <li class="toggle-toc">
      <a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button">
        <span>[&nbsp;</span><span>文章目录</span>
        <i class="text-collapsed icon icon-anchor"></i>
        <i class="text-in icon icon-close"></i>
        <span>]</span>
      </a>
    </li>
    
  </ul>
  
  
  <!-- Button trigger modal -->
  <button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button>
  <!-- <div class="wave-icon wave-icon-danger btn-donate" data-toggle="modal" data-target="#donateModal">
    <div class="wave-circle"><span class="icon"><i class="icon icon-bill"></i></span></div>
  </div> -->
  
  
  <div class="bar-right">
    
    <div class="share-component" data-sites="wechat" data-mobile-sites="wechat"></div>
    
  </div>
  </div>
</nav>
  
<!-- Modal -->
<div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content donate">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <div class="modal-body">
        <div class="donate-box">
          <div class="donate-head">
            <p>感谢您的支持，我会继续努力的!</p>
          </div>
          <div class="tab-content">
            <div role="tabpanel" class="tab-pane fade active in" id="alipay">
              <div class="donate-payimg">
                <img src="https://raw.githubusercontent.com/qidian360/oss/master/images/zfbsk.JPG" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">扫码打赏，你说多少就多少</p>
              <p class="text-grey">打开支付宝扫一扫，即可进行扫码打赏哦</p>
            </div>
            <div role="tabpanel" class="tab-pane fade" id="wechatpay">
              <div class="donate-payimg">
                <img src="https://raw.githubusercontent.com/qidian360/oss/master/images/wxsk.JPG" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">扫码打赏，你说多少就多少</p>
              <p class="text-grey">打开微信扫一扫，即可进行扫码打赏哦</p>
            </div>
          </div>
          <div class="donate-footer">
            <ul class="nav nav-tabs nav-justified" role="tablist">
              <li role="presentation" class="active">
                <a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="true"><i class="icon icon-alipay"></i> 支付宝</a>
              </li>
              <li role="presentation" class="">
                <a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="false"><i class="icon icon-wepay"></i> 微信支付</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>




</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/qidian360" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="/atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
        &copy; 2023 当我遇上你
        
        <div class="publishby">
        	Theme by <a href="https://github.com/cofess" target="_blank"> cofess </a>base on <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a>.
        </div>
    </div>
</footer>
  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>


<script src="/js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>






   
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





   
    
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/valine"></script>
  <script type="text/javascript">
  var GUEST = ['nick', 'mail', 'link'];
  var meta = 'nick,mail,link';
  meta = meta.split(',').filter(function(item) {
    return GUEST.indexOf(item) > -1;
  });
  new Valine({
    el: '#vcomments',
    verify: false,
    notify: false,
    appId: 'nPtA4r7LjqdHMXOW4Gs9yQz0-gzGzoHsz',
    appKey: 'UUYHyTz9su4cY3J1XDKWlxIH',
    placeholder: 'Just go go',
    avatar: 'mm',
    meta: meta,
    pageSize: '10' || 10,
    visitor: true
  });
  </script>

     







</body>
</html>