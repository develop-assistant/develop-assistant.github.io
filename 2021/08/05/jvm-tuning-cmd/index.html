<!DOCTYPE html>
<html lang=zh>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  <meta name="google-site-verification" content="zo0LqAAU1ik3Yk5Gdqg2DpsQI1Xlhh7jC07I0IGeyVc" />
  <meta name="baidu-site-verification" content="6LE45O63Sc" />
  <!-- 谷歌广告-->
  <!--<script data-ad-client="ca-pub-6442249173079218" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>-->
  
  
  <title>JVM调优指令 | 当我遇上你</title>
  <meta name="description" content="JVM调优指令  本文中的jdk版本为jdk8   JVM常用配置参数 12345678910-Xms2g：初始化推大小为 2g；-Xmx2g：堆最大内存为 2g；-XX:NewRatio&#x3D;4：设置年轻的和老年代的内存比例为 1:4；-XX:SurvivorRatio&#x3D;8：设置新生代 Eden 和 Survivor 比例为 8:2；–XX:+UseParNewGC：指定使用">
<meta property="og:type" content="article">
<meta property="og:title" content="JVM调优指令">
<meta property="og:url" content="https://idea360.cn/2021/08/05/jvm-tuning-cmd/index.html">
<meta property="og:site_name" content="当我遇上你">
<meta property="og:description" content="JVM调优指令  本文中的jdk版本为jdk8   JVM常用配置参数 12345678910-Xms2g：初始化推大小为 2g；-Xmx2g：堆最大内存为 2g；-XX:NewRatio&#x3D;4：设置年轻的和老年代的内存比例为 1:4；-XX:SurvivorRatio&#x3D;8：设置新生代 Eden 和 Survivor 比例为 8:2；–XX:+UseParNewGC：指定使用">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-08-05T15:50:16.000Z">
<meta property="article:modified_time" content="2021-09-11T05:17:39.475Z">
<meta property="article:author" content="当我遇上你">
<meta property="article:tag" content="调优">
<meta property="article:tag" content="jvm">
<meta name="twitter:card" content="summary">
  <!-- Canonical links -->
  <link rel="canonical" href="https://idea360.cn/2021/08/05/jvm-tuning-cmd/index.html">
  
    <link rel="alternate" href="/atom.xml" title="当我遇上你" type="application/atom+xml">
  
  
    <link rel="icon" href="https://gitee.com/idea360/oss/raw/master/images/favicon.png" type="image/x-icon">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  
  
  
<meta name="generator" content="Hexo 5.4.0"></head>


<body class="main-center theme-white" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="https://github.com/qidian360" target="_blank">
          <img class="img-circle img-rotate" src="https://gitee.com/idea360/oss/raw/master/images/one.png" width="200" height="200">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">当我遇上你</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md"></h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Beijing, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav ">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">首页</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">归档</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">分类</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-tags">
          <a href="/tags">
            
            <i class="icon icon-tags"></i>
            
            <span class="menu-title">标签</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-about">
          <a href="/about">
            
            <i class="icon icon-cup-fill"></i>
            
            <span class="menu-title">关于</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/qidian360" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="/atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p>欢迎交流与分享经验!</p><div><img src="https://gitee.com/idea360/oss/raw/master/images/wechat-qr-code.png" width="140px" height="140px"></div>
            </div>
        </div>
    </div>
</div>

    
  </div>
</aside>

  
  
<aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <nav id="toc" class="article-toc">
      <h3 class="toc-title">文章目录</h3>
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#jvm%E8%B0%83%E4%BC%98%E6%8C%87%E4%BB%A4"><span class="toc-number">1.</span> <span class="toc-text"> JVM调优指令</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#jvm%E5%B8%B8%E7%94%A8%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0"><span class="toc-number">1.1.</span> <span class="toc-text"> JVM常用配置参数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jdk%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7"><span class="toc-number">1.2.</span> <span class="toc-text"> jdk命令行工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-jps"><span class="toc-number">1.3.</span> <span class="toc-text"> 1. jps</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E5%B8%AE%E5%8A%A9"><span class="toc-number">1.3.1.</span> <span class="toc-text"> 命令帮助</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E8%AF%B4%E6%98%8E"><span class="toc-number">1.3.2.</span> <span class="toc-text"> 参数说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E8%AF%A6%E8%A7%A3"><span class="toc-number">1.3.3.</span> <span class="toc-text"> 示例详解</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-jstat"><span class="toc-number">1.4.</span> <span class="toc-text"> 2. jstat</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E5%B8%AE%E5%8A%A9-2"><span class="toc-number">1.4.1.</span> <span class="toc-text"> 命令帮助</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E8%AF%B4%E6%98%8E-2"><span class="toc-number">1.4.2.</span> <span class="toc-text"> 参数说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#option%E5%8F%82%E6%95%B0%E8%AF%B4%E6%98%8E"><span class="toc-number">1.4.3.</span> <span class="toc-text"> option参数说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E8%AF%A6%E8%A7%A3-2"><span class="toc-number">1.4.4.</span> <span class="toc-text"> 示例详解</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#-class"><span class="toc-number">1.4.4.1.</span> <span class="toc-text"> -class</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#-compiler"><span class="toc-number">1.4.4.2.</span> <span class="toc-text"> -compiler</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#-gc"><span class="toc-number">1.4.4.3.</span> <span class="toc-text"> -gc</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#-gccapacity"><span class="toc-number">1.4.4.4.</span> <span class="toc-text"> -gccapacity</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#-gcutils"><span class="toc-number">1.4.4.5.</span> <span class="toc-text"> -gcutils</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#-gccause"><span class="toc-number">1.4.4.6.</span> <span class="toc-text"> -gccause</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#-gcnew"><span class="toc-number">1.4.4.7.</span> <span class="toc-text"> -gcnew</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#-gcnewcapacity"><span class="toc-number">1.4.4.8.</span> <span class="toc-text"> -gcnewcapacity</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#-gcold"><span class="toc-number">1.4.4.9.</span> <span class="toc-text"> -gcold</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#-gcoldcapacity"><span class="toc-number">1.4.4.10.</span> <span class="toc-text"> -gcoldcapacity</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#-gcmetacapacity"><span class="toc-number">1.4.4.11.</span> <span class="toc-text"> -gcmetacapacity</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#-printcompilation"><span class="toc-number">1.4.4.12.</span> <span class="toc-text"> -printcompilation</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-jmap"><span class="toc-number">1.5.</span> <span class="toc-text"> 3. jmap</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E5%B8%AE%E5%8A%A9-3"><span class="toc-number">1.5.1.</span> <span class="toc-text"> 命令帮助</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E8%AF%A6%E8%A7%A3"><span class="toc-number">1.5.2.</span> <span class="toc-text"> 参数详解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E8%AF%A6%E8%A7%A3-3"><span class="toc-number">1.5.3.</span> <span class="toc-text"> 示例详解</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#-dump"><span class="toc-number">1.5.3.1.</span> <span class="toc-text"> -dump</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#-finalizerinfo"><span class="toc-number">1.5.3.2.</span> <span class="toc-text"> -finalizerinfo</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#-heap"><span class="toc-number">1.5.3.3.</span> <span class="toc-text"> -heap</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#-histo"><span class="toc-number">1.5.3.4.</span> <span class="toc-text"> -histo</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-jmap-java11"><span class="toc-number">1.6.</span> <span class="toc-text"> 3. jmap-java11</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#java%E7%89%88%E6%9C%AC"><span class="toc-number">1.6.1.</span> <span class="toc-text"> java版本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E5%B8%AE%E5%8A%A9-4"><span class="toc-number">1.6.2.</span> <span class="toc-text"> 命令帮助</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#histo"><span class="toc-number">1.6.3.</span> <span class="toc-text"> histo</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jmap"><span class="toc-number">1.6.4.</span> <span class="toc-text"> jmap</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-jhat"><span class="toc-number">1.7.</span> <span class="toc-text"> 4. jhat</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-jstack"><span class="toc-number">1.8.</span> <span class="toc-text"> 5. jstack</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E5%B8%AE%E5%8A%A9-5"><span class="toc-number">1.8.1.</span> <span class="toc-text"> 命令帮助</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E8%AF%A6%E8%A7%A3-2"><span class="toc-number">1.8.2.</span> <span class="toc-text"> 参数详解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E8%AF%A6%E6%83%85"><span class="toc-number">1.8.3.</span> <span class="toc-text"> 示例详情</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-jinfo"><span class="toc-number">1.9.</span> <span class="toc-text"> 6. jinfo</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E5%B8%AE%E5%8A%A9-6"><span class="toc-number">1.9.1.</span> <span class="toc-text"> 命令帮助</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E8%AF%A6%E8%A7%A3-3"><span class="toc-number">1.9.2.</span> <span class="toc-text"> 参数详解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E8%AF%A6%E6%83%85-2"><span class="toc-number">1.9.3.</span> <span class="toc-text"> 示例详情</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#-flags"><span class="toc-number">1.9.3.1.</span> <span class="toc-text"> -flags</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#-flag"><span class="toc-number">1.9.3.2.</span> <span class="toc-text"> -flag</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jvm%E6%9F%A5%E7%9C%8B%E8%BF%90%E8%A1%8C%E6%97%B6%E5%8F%82%E6%95%B0"><span class="toc-number">1.10.</span> <span class="toc-text"> JVM查看运行时参数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%9F%E6%88%90dump%E6%96%87%E4%BB%B6"><span class="toc-number">1.11.</span> <span class="toc-text"> 生成dump文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%9F%E4%BA%A7%E7%BA%A7jvm%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE"><span class="toc-number">1.12.</span> <span class="toc-text"> 生产级JVM参数配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jvm%E5%8F%82%E6%95%B0%E8%AE%BE%E7%BD%AE%E4%BC%98%E5%8C%96%E4%BE%8B%E5%AD%90"><span class="toc-number">1.13.</span> <span class="toc-text"> JVM参数设置优化例子</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9C%80%E5%90%8E"><span class="toc-number">2.</span> <span class="toc-text"> 最后</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">3.</span> <span class="toc-text"> 参考</span></a></li></ol>
    </nav>
  </div>
</aside>

<main class="main" role="main">
  <div class="content">
  <article id="post-jvm-tuning-cmd" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      JVM调优指令
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/2021/08/05/jvm-tuning-cmd/" class="article-date">
	  <time datetime="2021-08-05T15:50:16.000Z" itemprop="datePublished">2021-08-05</time>
	</a>
</span>
        
  <span class="article-category">
    <i class="icon icon-folder"></i>
    <a class="article-category-link" href="/categories/jvm/">jvm</a>
  </span>

        
  <span class="article-tag">
    <i class="icon icon-tags"></i>
	<a class="article-tag-link-link" href="/tags/jvm/" rel="tag">jvm</a>, <a class="article-tag-link-link" href="/tags/%E8%B0%83%E4%BC%98/" rel="tag">调优</a>
  </span>


        
	<span class="article-read hidden-xs">
	    <i class="icon icon-eye-fill" aria-hidden="true"></i>
	    <span id="busuanzi_container_page_pv">
			<span id="busuanzi_value_page_pv">0</span>
		</span>
	</span>


	<span class="article-read hidden-xs">
    	<i class="icon icon-eye-fill" aria-hidden="true"></i>
    	<span id="/2021/08/05/jvm-tuning-cmd/" class="leancloud_visitors"  data-flag-title="JVM调优指令">
			<span class="leancloud-visitors-count">0</span>
		</span>
    </span>

        <span class="post-comment"><i class="icon icon-comment"></i> <a href="/2021/08/05/jvm-tuning-cmd/#comments" class="article-comment-link">评论</a></span>
        
      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <h1 id="jvm调优指令"><a class="markdownIt-Anchor" href="#jvm调优指令"></a> JVM调优指令</h1>
<blockquote>
<p>本文中的jdk版本为jdk8</p>
</blockquote>
<h2 id="jvm常用配置参数"><a class="markdownIt-Anchor" href="#jvm常用配置参数"></a> JVM常用配置参数</h2>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-Xms2g：初始化推大小为 2g；</span><br><span class="line">-Xmx2g：堆最大内存为 2g；</span><br><span class="line">-XX:NewRatio&#x3D;4：设置年轻的和老年代的内存比例为 1:4；</span><br><span class="line">-XX:SurvivorRatio&#x3D;8：设置新生代 Eden 和 Survivor 比例为 8:2；</span><br><span class="line">–XX:+UseParNewGC：指定使用 ParNew + Serial Old 垃圾回收器组合；</span><br><span class="line">-XX:+UseParallelOldGC：指定使用 ParNew + ParNew Old 垃圾回收器组合；</span><br><span class="line">-XX:+UseConcMarkSweepGC：指定使用 CMS + Serial Old 垃圾回收器组合；</span><br><span class="line">-XX:+PrintGC：开启打印 gc 信息；</span><br><span class="line">-XX:+PrintGCDetails：打印 gc 详细信息。</span><br><span class="line">-XX:+HeapDumpOnOutOfMemoryError：  虚拟机在出现内存溢出异常时dump出当前内存堆转储快照以便事后进行分析</span><br></pre></td></tr></table></figure>
<h2 id="jdk命令行工具"><a class="markdownIt-Anchor" href="#jdk命令行工具"></a> jdk命令行工具</h2>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">jps: 显示系统内所有hotspot虚拟机进程</span><br><span class="line">jstat: 用于收集Hotspot虚拟机各方面的运行参数。</span><br><span class="line">jinfo: 显示虚拟机配置信息</span><br><span class="line">jmap: 生成虚拟机内存转储快照</span><br><span class="line">jhat: 用于分析heapdump文件，它会建立一个http/html服务器，让用户可以在浏览器上查看分析结果</span><br><span class="line">jstack: 显示虚拟机的线程快照</span><br></pre></td></tr></table></figure>
<h2 id="1-jps"><a class="markdownIt-Anchor" href="#1-jps"></a> 1. jps</h2>
<p><code>jps</code>(JVM Process Status) 命令类似 UNIX 的 <code>ps</code> 命令。</p>
<h3 id="命令帮助"><a class="markdownIt-Anchor" href="#命令帮助"></a> 命令帮助</h3>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2ze2e5wmatyx36v5jw5lz ~]# jps -help</span><br><span class="line">usage: jps [-help]</span><br><span class="line">       jps [-q] [-mlvV] [&lt;hostid&gt;]</span><br><span class="line"></span><br><span class="line">Definitions:</span><br><span class="line">    &lt;hostid&gt;:      &lt;hostname&gt;[:&lt;port&gt;]</span><br></pre></td></tr></table></figure>
<h3 id="参数说明"><a class="markdownIt-Anchor" href="#参数说明"></a> 参数说明</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-l : 输出主类全名或jar路径</span><br><span class="line">-q : 只输出LVMID</span><br><span class="line">-m : 输出JVM启动时传递给main()的参数</span><br><span class="line">-v : 输出JVM启动时显示指定的JVM参数</span><br></pre></td></tr></table></figure>
<h3 id="示例详解"><a class="markdownIt-Anchor" href="#示例详解"></a> 示例详解</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2ze2e5wmatyx36v5jw5lz ~]<span class="comment"># jps</span></span><br><span class="line">25378 Jps</span><br><span class="line">1701 idc-order-boot.jar</span><br><span class="line">[root@iz2ze2e5wmatyx36v5jw5lz ~]<span class="comment"># jps -l</span></span><br><span class="line">1701 target/idc-order-boot.jar</span><br><span class="line">25391 sun.tools.jps.Jps</span><br><span class="line">[root@iz2ze2e5wmatyx36v5jw5lz ~]<span class="comment"># jps -q</span></span><br><span class="line">25410</span><br><span class="line">1701</span><br><span class="line">[root@iz2ze2e5wmatyx36v5jw5lz ~]<span class="comment"># jps -m</span></span><br><span class="line">25425 Jps -m</span><br><span class="line">1701 idc-order-boot.jar --spring.profiles.active=dev --server.port=8080</span><br><span class="line">[root@iz2ze2e5wmatyx36v5jw5lz ~]<span class="comment"># jps -v</span></span><br><span class="line">25440 Jps -Denv.class.path=.:/usr/java/jdk1.8.0_201/jre/lib/rt.jar:/usr/java/jdk1.8.0_201/lib/dt.jar:/usr/java/jdk1.8.0_201/lib/tools.jar -Dapplication.home=/usr/java/jdk1.8.0_201 -Xms8m</span><br><span class="line">1701 idc-order-boot.jar</span><br></pre></td></tr></table></figure>
<h2 id="2-jstat"><a class="markdownIt-Anchor" href="#2-jstat"></a> 2. jstat</h2>
<p>jstat（JVM Statistics Monitoring Tool） 使用于监视虚拟机各种运行状态信息的命令行工具。 它可以显示本地或者远程（需要远程主机提供 RMI 支持）虚拟机进程中的类信息、内存、垃圾收集、JIT 编译等运行数据，在没有 GUI，只提供了纯文本控制台环境的服务器上，它将是运行期间定位虚拟机性能问题的首选工具。</p>
<h3 id="命令帮助-2"><a class="markdownIt-Anchor" href="#命令帮助-2"></a> 命令帮助</h3>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2ze2e5wmatyx36v5jw5lz ~]# jstat -help</span><br><span class="line">Usage: jstat -help|-options</span><br><span class="line">       jstat -&lt;option&gt; [-t] [-h&lt;lines&gt;] &lt;vmid&gt; [&lt;interval&gt; [&lt;count&gt;]]</span><br><span class="line"></span><br><span class="line">Definitions:</span><br><span class="line">  &lt;option&gt;      An option reported by the -options option</span><br><span class="line">  &lt;vmid&gt;        Virtual Machine Identifier. A vmid takes the following form:</span><br><span class="line">                     &lt;lvmid&gt;[@&lt;hostname&gt;[:&lt;port&gt;]]</span><br><span class="line">                Where &lt;lvmid&gt; is the local vm identifier for the target</span><br><span class="line">                Java virtual machine, typically a process id; &lt;hostname&gt; is</span><br><span class="line">                the name of the host running the target Java virtual machine;</span><br><span class="line">                and &lt;port&gt; is the port number for the rmiregistry on the</span><br><span class="line">                target host. See the jvmstat documentation for a more complete</span><br><span class="line">                description of the Virtual Machine Identifier.</span><br><span class="line">  &lt;lines&gt;       Number of samples between header lines.</span><br><span class="line">  &lt;interval&gt;    Sampling interval. The following forms are allowed:</span><br><span class="line">                    &lt;n&gt;[&quot;ms&quot;|&quot;s&quot;]</span><br><span class="line">                Where &lt;n&gt; is an integer and the suffix specifies the units as</span><br><span class="line">                milliseconds(&quot;ms&quot;) or seconds(&quot;s&quot;). The default units are &quot;ms&quot;.</span><br><span class="line">  &lt;count&gt;       Number of samples to take before terminating.</span><br><span class="line">  -J&lt;flag&gt;      Pass &lt;flag&gt; directly to the runtime system.</span><br><span class="line">[root@iz2ze2e5wmatyx36v5jw5lz ~]# jstat -options</span><br><span class="line">-class</span><br><span class="line">-compiler</span><br><span class="line">-gc</span><br><span class="line">-gccapacity</span><br><span class="line">-gccause</span><br><span class="line">-gcmetacapacity</span><br><span class="line">-gcnew</span><br><span class="line">-gcnewcapacity</span><br><span class="line">-gcold</span><br><span class="line">-gcoldcapacity</span><br><span class="line">-gcutil</span><br><span class="line">-printcompilation</span><br></pre></td></tr></table></figure>
<h3 id="参数说明-2"><a class="markdownIt-Anchor" href="#参数说明-2"></a> 参数说明</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[option] : 操作参数</span><br><span class="line">LVMID : 本地虚拟机进程ID</span><br><span class="line">[interval] : 连续输出的时间间隔</span><br><span class="line">[count] : 连续输出的次数</span><br></pre></td></tr></table></figure>
<h3 id="option参数说明"><a class="markdownIt-Anchor" href="#option参数说明"></a> option参数说明</h3>
<table>
<thead>
<tr>
<th>选项</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>-class</td>
<td>监视类装载、卸载数量、总空间以及类装载所耗费的时间</td>
</tr>
<tr>
<td>-gc</td>
<td>监视java堆状况，包括Eden区，2个servivor区、老年代、永久代等的容量、已用空间、GC时间合计等信息</td>
</tr>
<tr>
<td>-gccapacity</td>
<td>监视内容与-gc基本相同，但输出主要关注java堆各个区域使用到的最大、最小空间</td>
</tr>
<tr>
<td>-gcutil</td>
<td>监视内容与-gc基本相同，但输出主要关注已使用空间占总空间的百分比</td>
</tr>
<tr>
<td>-gccause</td>
<td>与-gcutil功能一样，但是会额外输出导致上一次gc产生的原因</td>
</tr>
<tr>
<td>-gcnew</td>
<td>监视新生代GC状况</td>
</tr>
<tr>
<td>-gcnewcapacity</td>
<td>监视内容与-gcnew基本相同，输出主要关注使用到的最大最小空间</td>
</tr>
<tr>
<td>-gcold</td>
<td>监视GC老年代状况</td>
</tr>
<tr>
<td>-gcoldcapacity</td>
<td>监视内容与-gcold基本相同，输出主要关注使用到的最大最小空间</td>
</tr>
<tr>
<td>-gcpermcapacity</td>
<td>输出永久代使用到的最大、最小空间</td>
</tr>
<tr>
<td>-compiler</td>
<td>输出JIT编译器编译过的方法、耗时等信息</td>
</tr>
<tr>
<td>-printcompilation</td>
<td>输出已经被JIT编译的方法</td>
</tr>
</tbody>
</table>
<h3 id="示例详解-2"><a class="markdownIt-Anchor" href="#示例详解-2"></a> 示例详解</h3>
<h4 id="-class"><a class="markdownIt-Anchor" href="#-class"></a> -class</h4>
<p>监视类装载、卸载数量、总空间以及耗费的时间</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2ze2e5wmatyx36v5jw5lz ~]# jstat -class 1701</span><br><span class="line">Loaded  Bytes  Unloaded  Bytes     Time</span><br><span class="line"> 14317 27168.2      140   209.1      25.95</span><br></pre></td></tr></table></figure>
<p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Loaded : 加载class的数量</span><br><span class="line">Bytes : class字节大小</span><br><span class="line">Unloaded : 未加载class的数量</span><br><span class="line">Bytes : 未加载class的字节大小</span><br><span class="line">Time : 加载时间</span><br></pre></td></tr></table></figure>
<h4 id="-compiler"><a class="markdownIt-Anchor" href="#-compiler"></a> -compiler</h4>
<p>输出JIT编译过的方法数量耗时等</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2ze2e5wmatyx36v5jw5lz ~]# jstat -compiler 1701</span><br><span class="line">Compiled Failed Invalid   Time   FailedType FailedMethod</span><br><span class="line">   13515      1       0   134.67          1 org/springframework/boot/loader/jar/Handler openConnection</span><br></pre></td></tr></table></figure>
<p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Compiled : 编译数量</span><br><span class="line">Failed : 编译失败数量</span><br><span class="line">Invalid : 无效数量</span><br><span class="line">Time : 编译耗时</span><br><span class="line">FailedType : 失败类型</span><br><span class="line">FailedMethod : 失败方法的全限定名</span><br></pre></td></tr></table></figure>
<h4 id="-gc"><a class="markdownIt-Anchor" href="#-gc"></a> -gc</h4>
<p>监视java堆状况，包括Eden区，2个servivor区、老年代、永久代等的容量、已用空间、GC时间合计等信息</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2ze2e5wmatyx36v5jw5lz ~]# jstat -gc 1701 1000 5</span><br><span class="line"> S0C    S1C    S0U    S1U      EC       EU        OC         OU       MC     MU    CCSC   CCSU   YGC     YGCT    FGC    FGCT     GCT</span><br><span class="line">5888.0 5888.0  0.0    0.0   47168.0   4656.0   117740.0   48648.4   86952.0 82657.6 10672.0 9866.7    306    6.441  14      2.882    9.323</span><br><span class="line">5888.0 5888.0  0.0    0.0   47168.0   4656.0   117740.0   48648.4   86952.0 82657.6 10672.0 9866.7    306    6.441  14      2.882    9.323</span><br><span class="line">5888.0 5888.0  0.0    0.0   47168.0   4656.0   117740.0   48648.4   86952.0 82657.6 10672.0 9866.7    306    6.441  14      2.882    9.323</span><br><span class="line">5888.0 5888.0  0.0    0.0   47168.0   4656.0   117740.0   48648.4   86952.0 82657.6 10672.0 9866.7    306    6.441  14      2.882    9.323</span><br><span class="line">5888.0 5888.0  0.0    0.0   47168.0   4656.0   117740.0   48648.4   86952.0 82657.6 10672.0 9866.7    306    6.441  14      2.882    9.323</span><br></pre></td></tr></table></figure>
<p>上述指令的意思是1701进程每隔1000ms输出一次gc情况，一共5次。</p>
<p>说明</p>
<p>C即Capacity 总容量，U即Used 已使用的容量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">S0C : survivor0区的总容量</span><br><span class="line">S1C : survivor1区的总容量</span><br><span class="line">S0U : survivor0区已使用的容量</span><br><span class="line">S1C : survivor1区已使用的容量</span><br><span class="line">EC : Eden区的总容量</span><br><span class="line">EU : Eden区已使用的容量</span><br><span class="line">OC : Old区的总容量</span><br><span class="line">OU : Old区已使用的容量</span><br><span class="line">MC : 当前元空间的容量 (KB)</span><br><span class="line">MU : Metaspace的使用 (KB)</span><br><span class="line">CCSC: 压缩类空间大小</span><br><span class="line">CCSU: 压缩类空间使用大小</span><br><span class="line">YGC : 新生代垃圾回收次数</span><br><span class="line">YGCT : 新生代垃圾回收时间</span><br><span class="line">FGC : 老年代垃圾回收次数</span><br><span class="line">FGCT : 老年代垃圾回收时间</span><br><span class="line">GCT : 垃圾回收总消耗时间</span><br></pre></td></tr></table></figure>
<h4 id="-gccapacity"><a class="markdownIt-Anchor" href="#-gccapacity"></a> -gccapacity</h4>
<p>同-gc，不过还会输出Java堆各区域使用到的最大、最小空间</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2ze2e5wmatyx36v5jw5lz ~]# jstat -gccapacity 1701</span><br><span class="line"> NGCMN    NGCMX     NGC     S0C   S1C       EC      OGCMN      OGCMX       OGC         OC       MCMN     MCMX      MC     CCSMN    CCSMX     CCSC    YGC    FGC</span><br><span class="line"> 10240.0 156992.0  58944.0 5888.0 5888.0  47168.0    20480.0   314048.0   117740.0   117740.0      0.0 1126400.0  86952.0      0.0 1048576.0  10672.0    306    14</span><br></pre></td></tr></table></figure>
<p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">NGCMN : 新生代占用的最小空间</span><br><span class="line">NGCMX : 新生代占用的最大空间</span><br><span class="line">OGCMN : 老年代占用的最小空间</span><br><span class="line">OGCMX : 老年代占用的最大空间</span><br><span class="line">OGC：当前年老代的容量 (KB)</span><br><span class="line">OC：当前年老代的空间 (KB)</span><br><span class="line">PGCMN : perm占用的最小空间</span><br><span class="line">PGCMX : perm占用的最大空间</span><br></pre></td></tr></table></figure>
<h4 id="-gcutils"><a class="markdownIt-Anchor" href="#-gcutils"></a> -gcutils</h4>
<p>监视内容与-gc基本相同，但输出主要关注已使用空间占总空间的百分比</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2ze2e5wmatyx36v5jw5lz ~]# jstat -gcutil 1701</span><br><span class="line">  S0     S1     E      O      M     CCS    YGC     YGCT    FGC    FGCT     GCT</span><br><span class="line">  0.00   0.00  11.78  41.32  95.06  92.45    306    6.441    14    2.882    9.323</span><br></pre></td></tr></table></figure>
<h4 id="-gccause"><a class="markdownIt-Anchor" href="#-gccause"></a> -gccause</h4>
<p>与-gcutil功能一样，但是会额外输出导致上一次gc产生的原因</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2ze2e5wmatyx36v5jw5lz ~]# jstat -gccause 1701</span><br><span class="line">  S0     S1     E      O      M     CCS    YGC     YGCT    FGC    FGCT     GCT    LGCC                 GCC</span><br><span class="line">  0.00   0.00  11.95  41.32  95.06  92.45    306    6.441    14    2.882    9.323 Heap Inspection Initiated GC No GC</span><br></pre></td></tr></table></figure>
<p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">LGCC：最近垃圾回收的原因</span><br><span class="line">GCC：当前垃圾回收的原因</span><br></pre></td></tr></table></figure>
<h4 id="-gcnew"><a class="markdownIt-Anchor" href="#-gcnew"></a> -gcnew</h4>
<p>统计新生代的行为</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2ze2e5wmatyx36v5jw5lz ~]# jstat -gcnew 1701</span><br><span class="line"> S0C    S1C    S0U    S1U   TT MTT  DSS      EC       EU     YGC     YGCT</span><br><span class="line">5888.0 5888.0    0.0    0.0  1  15 2080.0  47168.0   5656.6    306    6.441</span><br></pre></td></tr></table></figure>
<p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">TT：Tenuring threshold(提升阈值)</span><br><span class="line">MTT：最大的tenuring threshold</span><br><span class="line">DSS：survivor区域大小 (KB)</span><br></pre></td></tr></table></figure>
<h4 id="-gcnewcapacity"><a class="markdownIt-Anchor" href="#-gcnewcapacity"></a> -gcnewcapacity</h4>
<p>新生代与其相应的内存空间的统计</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2ze2e5wmatyx36v5jw5lz ~]# jstat -gcnewcapacity 1701</span><br><span class="line">  NGCMN      NGCMX       NGC      S0CMX     S0C     S1CMX     S1C       ECMX        EC      YGC   FGC</span><br><span class="line">   10240.0   156992.0    58944.0  15680.0   5888.0  15680.0   5888.0   125632.0    47168.0   306    14</span><br></pre></td></tr></table></figure>
<p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">NGC:当前年轻代的容量 (KB)</span><br><span class="line">S0CMX:最大的S0空间 (KB)</span><br><span class="line">S0C:当前S0空间 (KB)</span><br><span class="line">ECMX:最大eden空间 (KB)</span><br><span class="line">EC:当前eden空间 (KB)</span><br></pre></td></tr></table></figure>
<h4 id="-gcold"><a class="markdownIt-Anchor" href="#-gcold"></a> -gcold</h4>
<p>统计旧生代的行为</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2ze2e5wmatyx36v5jw5lz ~]# jstat -gcold 1701</span><br><span class="line">   MC       MU      CCSC     CCSU       OC          OU       YGC    FGC    FGCT     GCT</span><br><span class="line"> 86952.0  82657.6  10672.0   9866.7    117740.0     48648.4    306    14    2.882    9.323</span><br></pre></td></tr></table></figure>
<h4 id="-gcoldcapacity"><a class="markdownIt-Anchor" href="#-gcoldcapacity"></a> -gcoldcapacity</h4>
<p>统计旧生代的大小和空间</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2ze2e5wmatyx36v5jw5lz ~]# jstat -gcoldcapacity 1701</span><br><span class="line">   OGCMN       OGCMX        OGC         OC       YGC   FGC    FGCT     GCT</span><br><span class="line">    20480.0    314048.0    117740.0    117740.0   306    14    2.882    9.323</span><br></pre></td></tr></table></figure>
<h4 id="-gcmetacapacity"><a class="markdownIt-Anchor" href="#-gcmetacapacity"></a> -gcmetacapacity</h4>
<p>元空间统计</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2ze2e5wmatyx36v5jw5lz ~]# jstat -gcmetacapacity 1701</span><br><span class="line">   MCMN       MCMX        MC       CCSMN      CCSMX       CCSC     YGC   FGC    FGCT     GCT</span><br><span class="line">       0.0  1126400.0    86952.0        0.0  1048576.0    10672.0   306    14    2.882    9.323</span><br></pre></td></tr></table></figure>
<h4 id="-printcompilation"><a class="markdownIt-Anchor" href="#-printcompilation"></a> -printcompilation</h4>
<p>hotspot编译方法统计</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2ze2e5wmatyx36v5jw5lz ~]# jstat -printcompilation 1701</span><br><span class="line">Compiled  Size  Type Method</span><br><span class="line">   13515     22    1 java/util/ResourceBundle$CacheKey getLoader</span><br></pre></td></tr></table></figure>
<p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Compiled：被执行的编译任务的数量</span><br><span class="line">Size：方法字节码的字节数</span><br><span class="line">Type：编译类型</span><br><span class="line">Method：编译方法的类名和方法名。类名使用&quot;&#x2F;&quot; 代替 &quot;.&quot; 作为空间分隔符. 方法名是给出类的方法名. 格式是一致于HotSpot - XX:+PrintComplation 选项</span><br></pre></td></tr></table></figure>
<h2 id="3-jmap"><a class="markdownIt-Anchor" href="#3-jmap"></a> 3. jmap</h2>
<p><code>jmap</code>（Memory Map for Java）命令用于生成堆转储快照。 如果不使用 <code>jmap</code> 命令，要想获取 Java 堆转储，可以使用 <code>“-XX:+HeapDumpOnOutOfMemoryError”</code> 参数，可以让虚拟机在 OOM 异常出现之后自动生成 dump 文件，Linux 命令下可以通过 <code>kill -3</code> 发送进程退出信号也能拿到 dump 文件。</p>
<p><code>jmap</code> 的作用并不仅仅是为了获取 dump 文件，它还可以查询 finalizer 执行队列、Java 堆和永久代的详细信息，如空间使用率、当前使用的是哪种收集器等。和<code>jinfo</code>一样，<code>jmap</code>有不少功能在 Windows 平台下也是受限制的。</p>
<p>示例：将指定应用程序的堆快照输出到桌面。后面，可以通过 jhat、Visual VM 等工具分析该堆文件。</p>
<h3 id="命令帮助-3"><a class="markdownIt-Anchor" href="#命令帮助-3"></a> 命令帮助</h3>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2ze2e5wmatyx36v5jw5lz ~]# jmap -help</span><br><span class="line">Usage:</span><br><span class="line">    jmap [option] &lt;pid&gt;</span><br><span class="line">        (to connect to running process)</span><br><span class="line">    jmap [option] &lt;executable &lt;core&gt;</span><br><span class="line">        (to connect to a core file)</span><br><span class="line">    jmap [option] [server_id@]&lt;remote server IP or hostname&gt;</span><br><span class="line">        (to connect to remote debug server)</span><br><span class="line"></span><br><span class="line">where &lt;option&gt; is one of:</span><br><span class="line">    &lt;none&gt;               to print same info as Solaris pmap</span><br><span class="line">    -heap                to print java heap summary</span><br><span class="line">    -histo[:live]        to print histogram of java object heap; if the &quot;live&quot;</span><br><span class="line">                         suboption is specified, only count live objects</span><br><span class="line">    -clstats             to print class loader statistics</span><br><span class="line">    -finalizerinfo       to print information on objects awaiting finalization</span><br><span class="line">    -dump:&lt;dump-options&gt; to dump java heap in hprof binary format</span><br><span class="line">                         dump-options:</span><br><span class="line">                           live         dump only live objects; if not specified,</span><br><span class="line">                                        all objects in the heap are dumped.</span><br><span class="line">                           format=b     binary format</span><br><span class="line">                           file=&lt;file&gt;  dump heap to &lt;file&gt;</span><br><span class="line">                         Example: jmap -dump:live,format=b,file=heap.bin &lt;pid&gt;</span><br><span class="line">    -F                   force. Use with -dump:&lt;dump-options&gt; &lt;pid&gt; or -histo</span><br><span class="line">                         to force a heap dump or histogram when &lt;pid&gt; does not</span><br><span class="line">                         respond. The &quot;live&quot; suboption is not supported</span><br><span class="line">                         in this mode.</span><br><span class="line">    -h | -help           to print this help message</span><br><span class="line">    -J&lt;flag&gt;             to pass &lt;flag&gt; directly to the runtime system</span><br></pre></td></tr></table></figure>
<h3 id="参数详解"><a class="markdownIt-Anchor" href="#参数详解"></a> 参数详解</h3>
<table>
<thead>
<tr>
<th>选项</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>-dump</td>
<td>生成java堆转储快照。格式为:-dump:[live, ]format=b, file=,其中live子参数说明是否只dump出存活的对象</td>
</tr>
<tr>
<td>-finalizerinfo</td>
<td>显示在finalizer线程执行finalize方法的对象，只在linux平台下有效</td>
</tr>
<tr>
<td>-heap</td>
<td>显示java堆详细信息，如使用哪些回收器、参数配置、分代状况等。只在linux平台下有效</td>
</tr>
<tr>
<td>-histo</td>
<td>显示堆中对象统计信息，包括类、实例数量、合计容量</td>
</tr>
<tr>
<td>-permstat</td>
<td>以Classloader为统计口径显示永久代内存状态。只在linux平台下有效</td>
</tr>
<tr>
<td>-F</td>
<td>当虚拟机进程对-dump选项没有响应时，可使用这个选项强制生成dump快照，只在linux平台下有效</td>
</tr>
</tbody>
</table>
<h3 id="示例详解-3"><a class="markdownIt-Anchor" href="#示例详解-3"></a> 示例详解</h3>
<h4 id="-dump"><a class="markdownIt-Anchor" href="#-dump"></a> -dump</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2ze2e5wmatyx36v5jw5lz ~]# jmap -dump:format=b,file=dump.hprof 1701</span><br><span class="line">Dumping heap to /root/dump.hprof ...</span><br><span class="line">File exists</span><br></pre></td></tr></table></figure>
<p>dump堆到文件,format指定输出格式，live指明是活着的对象,file指定文件名。dump.hprof这个后缀是为了后续可以直接用MAT(Memory Anlysis Tool)打开。</p>
<h4 id="-finalizerinfo"><a class="markdownIt-Anchor" href="#-finalizerinfo"></a> -finalizerinfo</h4>
<p>打印等待回收对象的信息</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2ze2e5wmatyx36v5jw5lz ~]# jmap -finalizerinfo 1701</span><br><span class="line">Attaching to process ID 1701, please wait...</span><br><span class="line">Debugger attached successfully.</span><br><span class="line">Server compiler detected.</span><br><span class="line">JVM version is 25.201-b09</span><br><span class="line">Number of objects pending for finalization: 0</span><br></pre></td></tr></table></figure>
<p>可以看到当前F-QUEUE队列中并没有等待Finalizer线程执行finalizer方法的对象。</p>
<h4 id="-heap"><a class="markdownIt-Anchor" href="#-heap"></a> -heap</h4>
<p>打印heap的概要信息，GC使用的算法，heap的配置及wise heap的使用情况,可以用此来判断内存目前的使用情况以及垃圾回收情况</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2ze2e5wmatyx36v5jw5lz ~]# jmap -heap 1701</span><br><span class="line">Attaching to process ID 1701, please wait...</span><br><span class="line">Debugger attached successfully.</span><br><span class="line">Server compiler detected.</span><br><span class="line">JVM version is 25.201-b09</span><br><span class="line"></span><br><span class="line">using thread-local object allocation.</span><br><span class="line">Mark Sweep Compact GC   //GC 方式  </span><br><span class="line"></span><br><span class="line">Heap Configuration: //堆内存初始化配置</span><br><span class="line">   MinHeapFreeRatio         = 40    //对应jvm启动参数-XX:MinHeapFreeRatio设置JVM堆最小空闲比率</span><br><span class="line">   MaxHeapFreeRatio         = 70    //对应jvm启动参数 -XX:MaxHeapFreeRatio设置JVM堆最大空闲比率</span><br><span class="line">   MaxHeapSize              = 482344960 (460.0MB) //对应jvm启动参数-XX:MaxHeapSize=设置JVM堆的最大大小</span><br><span class="line">   NewSize                  = 10485760 (10.0MB) //对应jvm启动参数-XX:NewSize=设置JVM堆的‘新生代’的默认大小</span><br><span class="line">   MaxNewSize               = 160759808 (153.3125MB)    //对应jvm启动参数-XX:MaxNewSize=设置JVM堆的‘新生代’的最大大小</span><br><span class="line">   OldSize                  = 20971520 (20.0MB)  //对应jvm启动参数-XX:OldSize=&lt;value&gt;:设置JVM堆的‘老生代’的大小</span><br><span class="line">   NewRatio                 = 2 //对应jvm启动参数-XX:OldSize=&lt;value&gt;:设置JVM堆的‘老生代’的大小</span><br><span class="line">   SurvivorRatio            = 8 //对应jvm启动参数-XX:SurvivorRatio=设置年轻代中Eden区与Survivor区的大小比值 </span><br><span class="line">   MetaspaceSize            = 21807104 (20.796875MB) //元空间初始大小</span><br><span class="line">   CompressedClassSpaceSize = 1073741824 (1024.0MB)</span><br><span class="line">   MaxMetaspaceSize         = 17592186044415 MB</span><br><span class="line">   G1HeapRegionSize         = 0 (0.0MB)</span><br><span class="line"></span><br><span class="line">Heap Usage: //堆内存使用情况</span><br><span class="line">New Generation (Eden + 1 Survivor Space):</span><br><span class="line">   capacity = 54329344 (51.8125MB)</span><br><span class="line">   used     = 7109688 (6.780326843261719MB)</span><br><span class="line">   free     = 47219656 (45.03217315673828MB)</span><br><span class="line">   13.086276175173401% used</span><br><span class="line">Eden Space:  //Eden区内存分布</span><br><span class="line">   capacity = 48300032 (46.0625MB) //Eden区总容量</span><br><span class="line">   used     = 7109688 (6.780326843261719MB) //Eden区已使用</span><br><span class="line">   free     = 41190344 (39.28217315673828MB) //Eden区剩余容量</span><br><span class="line">   14.719841179401289% used</span><br><span class="line">From Space:</span><br><span class="line">   capacity = 6029312 (5.75MB)</span><br><span class="line">   used     = 0 (0.0MB)</span><br><span class="line">   free     = 6029312 (5.75MB)</span><br><span class="line">   0.0% used</span><br><span class="line">To Space:</span><br><span class="line">   capacity = 6029312 (5.75MB)</span><br><span class="line">   used     = 0 (0.0MB)</span><br><span class="line">   free     = 6029312 (5.75MB)</span><br><span class="line">   0.0% used</span><br><span class="line">tenured generation: //老年代内存分布</span><br><span class="line">   capacity = 120565760 (114.98046875MB)</span><br><span class="line">   used     = 49815952 (47.50819396972656MB)</span><br><span class="line">   free     = 70749808 (67.47227478027344MB)</span><br><span class="line">   41.318490423815184% used</span><br><span class="line"></span><br><span class="line">27371 interned Strings occupying 2942608 bytes.</span><br></pre></td></tr></table></figure>
<h4 id="-histo"><a class="markdownIt-Anchor" href="#-histo"></a> -histo</h4>
<p>打印堆的对象统计，包括对象数、内存大小等等 （因为在dump:live前会进行full gc，如果带上live则只统计活对象，因此不加live的堆大小要大于加live堆的大小 ）</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">jmap -histo:live 1701 | less</span><br><span class="line"> num     #instances         #bytes  class name</span><br><span class="line">----------------------------------------------</span><br><span class="line">   1:          4358       18044728  [B</span><br><span class="line">   2:         97247        8984344  [C</span><br><span class="line">   3:         26579        2338952  java.lang.reflect.Method</span><br><span class="line">   4:         96737        2321688  java.lang.String</span><br><span class="line">   5:         58232        1863424  java.util.concurrent.ConcurrentHashMap$Node</span><br><span class="line">   6:         22337        1824304  [Ljava.lang.Object;</span><br><span class="line">   7:         15080        1675792  java.lang.Class</span><br><span class="line">   8:         24027         961080  java.util.LinkedHashMap$Entry</span><br><span class="line">   9:          6227         917008  [I</span><br><span class="line">  10:         10500         797288  [Ljava.util.HashMap$Node;</span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>
<h2 id="3-jmap-java11"><a class="markdownIt-Anchor" href="#3-jmap-java11"></a> 3. jmap-java11</h2>
<h3 id="java版本"><a class="markdownIt-Anchor" href="#java版本"></a> java版本</h3>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ java -version</span><br><span class="line">openjdk version &quot;11.0.9&quot; 2020-10-20</span><br><span class="line">OpenJDK Runtime Environment (build 11.0.9+11)</span><br><span class="line">OpenJDK 64-Bit Server VM (build 11.0.9+11, mixed mode)</span><br></pre></td></tr></table></figure>
<h3 id="命令帮助-4"><a class="markdownIt-Anchor" href="#命令帮助-4"></a> 命令帮助</h3>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ jmap -help</span><br><span class="line">Usage:</span><br><span class="line">    jmap -clstats &lt;pid&gt;</span><br><span class="line">        to connect to running process and print class loader statistics</span><br><span class="line">    jmap -finalizerinfo &lt;pid&gt;</span><br><span class="line">        to connect to running process and print information on objects awaiting finalization</span><br><span class="line">    jmap -histo[:live] &lt;pid&gt;</span><br><span class="line">        to connect to running process and print histogram of java object heap</span><br><span class="line">        if the &quot;live&quot; suboption is specified, only count live objects</span><br><span class="line">    jmap -dump:&lt;dump-options&gt; &lt;pid&gt;</span><br><span class="line">        to connect to running process and dump java heap</span><br><span class="line">    jmap -? -h --help</span><br><span class="line">        to print this help message</span><br><span class="line"></span><br><span class="line">    dump-options:</span><br><span class="line">      live         dump only live objects; if not specified,</span><br><span class="line">                   all objects in the heap are dumped.</span><br><span class="line">      format=b     binary format</span><br><span class="line">      file=&lt;file&gt;  dump heap to &lt;file&gt;</span><br><span class="line"></span><br><span class="line">    Example: jmap -dump:live,format=b,file=heap.bin &lt;pid&gt;</span><br></pre></td></tr></table></figure>
<h3 id="histo"><a class="markdownIt-Anchor" href="#histo"></a> histo</h3>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jmap -histo:live 67658 &gt; 1.txt</span><br></pre></td></tr></table></figure>
<h3 id="jmap"><a class="markdownIt-Anchor" href="#jmap"></a> jmap</h3>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">➜  Desktop jhsdb jmap -helo</span><br><span class="line">You have to set --pid or --exe or --connect.</span><br><span class="line">    &lt;no option&gt;             To print same info as Solaris pmap.</span><br><span class="line">    --heap                  To print java heap summary.</span><br><span class="line">    --binaryheap            To dump java heap in hprof binary format.</span><br><span class="line">    --dumpfile &lt;name&gt;       The name of the dump file.</span><br><span class="line">    --histo                 To print histogram of java object heap.</span><br><span class="line">    --clstats               To print class loader statistics.</span><br><span class="line">    --finalizerinfo         To print information on objects awaiting finalization.</span><br><span class="line">    --pid &lt;pid&gt;             To attach to and operate on the given live process.</span><br><span class="line">    --core &lt;corefile&gt;       To operate on the given core file.</span><br><span class="line">    --exe &lt;executable for corefile&gt;</span><br><span class="line">    --connect [&lt;id&gt;@]&lt;host&gt; To connect to a remote debug server (debugd).</span><br><span class="line"></span><br><span class="line">    The --core and --exe options must be set together to give the core</span><br><span class="line">    file, and associated executable, to operate on. They can use</span><br><span class="line">    absolute or relative paths.</span><br><span class="line">    The --pid option can be set to operate on a live process.</span><br><span class="line">    The --connect option can be set to connect to a debug server (debugd).</span><br><span class="line">    --core, --pid, and --connect are mutually exclusive.</span><br><span class="line"></span><br><span class="line">    Examples: jhsdb jmap --pid 1234</span><br><span class="line">          or  jhsdb jmap --core ./core.1234 --exe ./myexe</span><br><span class="line">          or  jhsdb jmap --connect debugserver</span><br><span class="line">          or  jhsdb jmap --connect id@debugserver</span><br></pre></td></tr></table></figure>
<h2 id="4-jhat"><a class="markdownIt-Anchor" href="#4-jhat"></a> 4. jhat</h2>
<p>jhat(JVM Heap Analysis Tool)命令是与jmap搭配使用，用来分析jmap生成的dump，jhat内置了一个微型的HTTP/HTML服务器，生成dump的分析结果后，可以在浏览器中查看。在此要注意，一般不会直接在服务器上进行分析，因为jhat是一个耗时并且耗费硬件资源的过程，一般把服务器生成的dump文件复制到本地或其他机器上进行分析。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jhat [dumpfile]</span><br></pre></td></tr></table></figure>
<p><strong>分析同样一个dump快照，MAT需要的额外内存比jhat要小的多的多，所以建议使用MAT来进行分析，当然也看个人偏好。</strong></p>
<p>具体排查时需要结合代码，观察是否大量应该被回收的对象在一直被引用或者是否有占用内存特别大的对象无法被回收。<br />
<strong>一般情况，会down到客户端用工具来分析</strong></p>
<h2 id="5-jstack"><a class="markdownIt-Anchor" href="#5-jstack"></a> 5. jstack</h2>
<p><code>jstack</code>（Stack Trace for Java）命令用于生成虚拟机当前时刻的线程快照。线程快照就是当前虚拟机内每一条线程正在执行的方法堆栈的集合.</p>
<p>生成线程快照的目的主要是定位线程长时间出现停顿的原因，如线程间死锁、死循环、请求外部资源导致的长时间等待等都是导致线程长时间停顿的原因。线程出现停顿的时候通过<code>jstack</code>来查看各个线程的调用堆栈，就可以知道没有响应的线程到底在后台做些什么事情，或者在等待些什么资源。</p>
<h3 id="命令帮助-5"><a class="markdownIt-Anchor" href="#命令帮助-5"></a> 命令帮助</h3>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2ze2e5wmatyx36v5jw5lz ~]# jstack -help</span><br><span class="line">Usage:</span><br><span class="line">    jstack [-l] &lt;pid&gt;</span><br><span class="line">        (to connect to running process)</span><br><span class="line">    jstack -F [-m] [-l] &lt;pid&gt;</span><br><span class="line">        (to connect to a hung process)</span><br><span class="line">    jstack [-m] [-l] &lt;executable&gt; &lt;core&gt;</span><br><span class="line">        (to connect to a core file)</span><br><span class="line">    jstack [-m] [-l] [server_id@]&lt;remote server IP or hostname&gt;</span><br><span class="line">        (to connect to a remote debug server)</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">    -F  to force a thread dump. Use when jstack &lt;pid&gt; does not respond (process is hung)</span><br><span class="line">    -m  to print both java and native frames (mixed mode)</span><br><span class="line">    -l  long listing. Prints additional information about locks</span><br><span class="line">    -h or -help to print this help message</span><br></pre></td></tr></table></figure>
<h3 id="参数详解-2"><a class="markdownIt-Anchor" href="#参数详解-2"></a> 参数详解</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-F : 当正常输出请求不被响应时，强制输出线程堆栈</span><br><span class="line">-l : 除堆栈外，显示关于锁的附加信息</span><br><span class="line">-m : 如果调用到本地方法的话，可以显示C&#x2F;C++的堆栈</span><br></pre></td></tr></table></figure>
<h3 id="示例详情"><a class="markdownIt-Anchor" href="#示例详情"></a> 示例详情</h3>
<p><strong>下面是一个线程死锁的代码。我们下面会通过 <code>jstack</code> 命令进行死锁检查，输出死锁信息，找到发生死锁的线程。</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.javaedge.concurrency.example.deadLock;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DeadLockDemo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Object resource1 = <span class="keyword">new</span> Object();<span class="comment">//资源 1</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Object resource2 = <span class="keyword">new</span> Object();<span class="comment">//资源 2</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (resource1) &#123;</span><br><span class="line">                System.out.println(Thread.currentThread() + <span class="string">&quot;get resource1&quot;</span>);</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">                System.out.println(Thread.currentThread() + <span class="string">&quot;waiting get resource2&quot;</span>);</span><br><span class="line">                <span class="keyword">synchronized</span> (resource2) &#123;</span><br><span class="line">                    System.out.println(Thread.currentThread() + <span class="string">&quot;get resource2&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, <span class="string">&quot;线程 1&quot;</span>).start();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (resource2) &#123;</span><br><span class="line">                System.out.println(Thread.currentThread() + <span class="string">&quot;get resource2&quot;</span>);</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">                System.out.println(Thread.currentThread() + <span class="string">&quot;waiting get resource1&quot;</span>);</span><br><span class="line">                <span class="keyword">synchronized</span> (resource1) &#123;</span><br><span class="line">                    System.out.println(Thread.currentThread() + <span class="string">&quot;get resource1&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, <span class="string">&quot;线程 2&quot;</span>).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>线程 A 通过 synchronized (resource1) 获得 resource1 的监视器锁，然后通过<code>Thread.sleep(1000);</code>让线程 A 休眠 1s 为的是让线程 B 得到执行然后获取到 resource2 的监视器锁。线程 A 和线程 B 休眠结束了都开始企图请求获取对方的资源，然后这两个线程就会陷入互相等待的状态，这也就产生了死锁。</p>
<p><strong>通过 <code>jstack</code> 命令分析：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line">➜  Java-Concurrency-Progamming-Tutorial git:(master) ✗ jstack 26752</span><br><span class="line">2020-02-08 15:07:20</span><br><span class="line">Full thread dump Java HotSpot(TM) 64-Bit Server VM (25.211-b12 mixed mode):</span><br><span class="line"></span><br><span class="line">&quot;Attach Listener&quot; #16 daemon prio&#x3D;9 os_prio&#x3D;31 tid&#x3D;0x00007ff49814c800 nid&#x3D;0x3207 waiting on condition [0x0000000000000000]</span><br><span class="line">   java.lang.Thread.State: RUNNABLE</span><br><span class="line"></span><br><span class="line">&quot;DestroyJavaVM&quot; #15 prio&#x3D;5 os_prio&#x3D;31 tid&#x3D;0x00007ff495857800 nid&#x3D;0xd03 waiting on condition [0x0000000000000000]</span><br><span class="line">   java.lang.Thread.State: RUNNABLE</span><br><span class="line"></span><br><span class="line">&quot;线程 2&quot; #14 prio&#x3D;5 os_prio&#x3D;31 tid&#x3D;0x00007ff498836800 nid&#x3D;0x5903 waiting for monitor entry [0x0000700005b7e000]</span><br><span class="line">   java.lang.Thread.State: BLOCKED (on object monitor)</span><br><span class="line">        at com.javaedge.concurrency.example.deadLock.DeadLockDemo.lambda$main$1(DeadLockDemo.java:34)</span><br><span class="line">        - waiting to lock &lt;0x000000076af91968&gt; (a java.lang.Object)</span><br><span class="line">        - locked &lt;0x000000076af91978&gt; (a java.lang.Object)</span><br><span class="line">        at com.javaedge.concurrency.example.deadLock.DeadLockDemo$$Lambda$2&#x2F;194494468.run(Unknown Source)</span><br><span class="line">        at java.lang.Thread.run(Thread.java:748)</span><br><span class="line"></span><br><span class="line">&quot;线程 1&quot; #13 prio&#x3D;5 os_prio&#x3D;31 tid&#x3D;0x00007ff499876000 nid&#x3D;0xa703 waiting for monitor entry [0x0000700005a7b000]</span><br><span class="line">   java.lang.Thread.State: BLOCKED (on object monitor)</span><br><span class="line">        at com.javaedge.concurrency.example.deadLock.DeadLockDemo.lambda$main$0(DeadLockDemo.java:19)</span><br><span class="line">        - waiting to lock &lt;0x000000076af91978&gt; (a java.lang.Object)</span><br><span class="line">        - locked &lt;0x000000076af91968&gt; (a java.lang.Object)</span><br><span class="line">        at com.javaedge.concurrency.example.deadLock.DeadLockDemo$$Lambda$1&#x2F;972765878.run(Unknown Source)</span><br><span class="line">        at java.lang.Thread.run(Thread.java:748)</span><br><span class="line"></span><br><span class="line">&quot;Service Thread&quot; #12 daemon prio&#x3D;9 os_prio&#x3D;31 tid&#x3D;0x00007ff495820800 nid&#x3D;0xa903 runnable [0x0000000000000000]</span><br><span class="line">   java.lang.Thread.State: RUNNABLE</span><br><span class="line"></span><br><span class="line">&quot;C1 CompilerThread3&quot; #11 daemon prio&#x3D;9 os_prio&#x3D;31 tid&#x3D;0x00007ff49612f800 nid&#x3D;0x5503 waiting on condition [0x0000000000000000]</span><br><span class="line">   java.lang.Thread.State: RUNNABLE</span><br><span class="line"></span><br><span class="line">&quot;C2 CompilerThread2&quot; #10 daemon prio&#x3D;9 os_prio&#x3D;31 tid&#x3D;0x00007ff497014000 nid&#x3D;0x3f03 waiting on condition [0x0000000000000000]</span><br><span class="line">   java.lang.Thread.State: RUNNABLE</span><br><span class="line"></span><br><span class="line">&quot;C2 CompilerThread1&quot; #9 daemon prio&#x3D;9 os_prio&#x3D;31 tid&#x3D;0x00007ff497013800 nid&#x3D;0x3d03 waiting on condition [0x0000000000000000]</span><br><span class="line">   java.lang.Thread.State: RUNNABLE</span><br><span class="line"></span><br><span class="line">&quot;C2 CompilerThread0&quot; #8 daemon prio&#x3D;9 os_prio&#x3D;31 tid&#x3D;0x00007ff499880800 nid&#x3D;0x3c03 waiting on condition [0x0000000000000000]</span><br><span class="line">   java.lang.Thread.State: RUNNABLE</span><br><span class="line"></span><br><span class="line">&quot;JDWP Command Reader&quot; #7 daemon prio&#x3D;10 os_prio&#x3D;31 tid&#x3D;0x00007ff497009000 nid&#x3D;0x3a03 runnable [0x0000000000000000]</span><br><span class="line">   java.lang.Thread.State: RUNNABLE</span><br><span class="line"></span><br><span class="line">&quot;JDWP Event Helper Thread&quot; #6 daemon prio&#x3D;10 os_prio&#x3D;31 tid&#x3D;0x00007ff497004800 nid&#x3D;0x4203 runnable [0x0000000000000000]</span><br><span class="line">   java.lang.Thread.State: RUNNABLE</span><br><span class="line"></span><br><span class="line">&quot;JDWP Transport Listener: dt_socket&quot; #5 daemon prio&#x3D;10 os_prio&#x3D;31 tid&#x3D;0x00007ff497003800 nid&#x3D;0x4407 runnable [0x0000000000000000]</span><br><span class="line">   java.lang.Thread.State: RUNNABLE</span><br><span class="line"></span><br><span class="line">&quot;Signal Dispatcher&quot; #4 daemon prio&#x3D;9 os_prio&#x3D;31 tid&#x3D;0x00007ff49902d800 nid&#x3D;0x3803 runnable [0x0000000000000000]</span><br><span class="line">   java.lang.Thread.State: RUNNABLE</span><br><span class="line"></span><br><span class="line">&quot;Finalizer&quot; #3 daemon prio&#x3D;8 os_prio&#x3D;31 tid&#x3D;0x00007ff497005800 nid&#x3D;0x4b03 in Object.wait() [0x0000700004e54000]</span><br><span class="line">   java.lang.Thread.State: WAITING (on object monitor)</span><br><span class="line">        at java.lang.Object.wait(Native Method)</span><br><span class="line">        - waiting on &lt;0x000000076ab08ed0&gt; (a java.lang.ref.ReferenceQueue$Lock)</span><br><span class="line">        at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:144)</span><br><span class="line">        - locked &lt;0x000000076ab08ed0&gt; (a java.lang.ref.ReferenceQueue$Lock)</span><br><span class="line">        at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:165)</span><br><span class="line">        at java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:216)</span><br><span class="line"></span><br><span class="line">&quot;Reference Handler&quot; #2 daemon prio&#x3D;10 os_prio&#x3D;31 tid&#x3D;0x00007ff496835000 nid&#x3D;0x4d03 in Object.wait() [0x0000700004d51000]</span><br><span class="line">   java.lang.Thread.State: WAITING (on object monitor)</span><br><span class="line">        at java.lang.Object.wait(Native Method)</span><br><span class="line">        - waiting on &lt;0x000000076ab06bf8&gt; (a java.lang.ref.Reference$Lock)</span><br><span class="line">        at java.lang.Object.wait(Object.java:502)</span><br><span class="line">        at java.lang.ref.Reference.tryHandlePending(Reference.java:191)</span><br><span class="line">        - locked &lt;0x000000076ab06bf8&gt; (a java.lang.ref.Reference$Lock)</span><br><span class="line">        at java.lang.ref.Reference$ReferenceHandler.run(Reference.java:153)</span><br><span class="line"></span><br><span class="line">&quot;VM Thread&quot; os_prio&#x3D;31 tid&#x3D;0x00007ff49682e800 nid&#x3D;0x2e03 runnable </span><br><span class="line"></span><br><span class="line">&quot;GC task thread#0 (ParallelGC)&quot; os_prio&#x3D;31 tid&#x3D;0x00007ff498803800 nid&#x3D;0x2207 runnable </span><br><span class="line"></span><br><span class="line">&quot;GC task thread#1 (ParallelGC)&quot; os_prio&#x3D;31 tid&#x3D;0x00007ff498804000 nid&#x3D;0x2103 runnable </span><br><span class="line"></span><br><span class="line">&quot;GC task thread#2 (ParallelGC)&quot; os_prio&#x3D;31 tid&#x3D;0x00007ff498804800 nid&#x3D;0x1e03 runnable </span><br><span class="line"></span><br><span class="line">&quot;GC task thread#3 (ParallelGC)&quot; os_prio&#x3D;31 tid&#x3D;0x00007ff498805000 nid&#x3D;0x2a03 runnable </span><br><span class="line"></span><br><span class="line">&quot;GC task thread#4 (ParallelGC)&quot; os_prio&#x3D;31 tid&#x3D;0x00007ff498806000 nid&#x3D;0x5403 runnable </span><br><span class="line"></span><br><span class="line">&quot;GC task thread#5 (ParallelGC)&quot; os_prio&#x3D;31 tid&#x3D;0x00007ff496802000 nid&#x3D;0x5303 runnable </span><br><span class="line"></span><br><span class="line">&quot;GC task thread#6 (ParallelGC)&quot; os_prio&#x3D;31 tid&#x3D;0x00007ff496802800 nid&#x3D;0x5103 runnable </span><br><span class="line"></span><br><span class="line">&quot;GC task thread#7 (ParallelGC)&quot; os_prio&#x3D;31 tid&#x3D;0x00007ff495800800 nid&#x3D;0x4f03 runnable </span><br><span class="line"></span><br><span class="line">&quot;VM Periodic Task Thread&quot; os_prio&#x3D;31 tid&#x3D;0x00007ff498824800 nid&#x3D;0x5703 waiting on condition </span><br><span class="line"></span><br><span class="line">JNI global references: 2505</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Found one Java-level deadlock:</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">&quot;线程 2&quot;:</span><br><span class="line">  waiting to lock monitor 0x00007ff4998056a8 (object 0x000000076af91968, a java.lang.Object),</span><br><span class="line">  which is held by &quot;线程 1&quot;</span><br><span class="line">&quot;线程 1&quot;:</span><br><span class="line">  waiting to lock monitor 0x00007ff499801608 (object 0x000000076af91978, a java.lang.Object),</span><br><span class="line">  which is held by &quot;线程 2&quot;</span><br><span class="line"></span><br><span class="line">Java stack information for the threads listed above:</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">&quot;线程 2&quot;:</span><br><span class="line">        at com.javaedge.concurrency.example.deadLock.DeadLockDemo.lambda$main$1(DeadLockDemo.java:34)</span><br><span class="line">        - waiting to lock &lt;0x000000076af91968&gt; (a java.lang.Object)</span><br><span class="line">        - locked &lt;0x000000076af91978&gt; (a java.lang.Object)</span><br><span class="line">        at com.javaedge.concurrency.example.deadLock.DeadLockDemo$$Lambda$2&#x2F;194494468.run(Unknown Source)</span><br><span class="line">        at java.lang.Thread.run(Thread.java:748)</span><br><span class="line">&quot;线程 1&quot;:</span><br><span class="line">        at com.javaedge.concurrency.example.deadLock.DeadLockDemo.lambda$main$0(DeadLockDemo.java:19)</span><br><span class="line">        - waiting to lock &lt;0x000000076af91978&gt; (a java.lang.Object)</span><br><span class="line">        - locked &lt;0x000000076af91968&gt; (a java.lang.Object)</span><br><span class="line">        at com.javaedge.concurrency.example.deadLock.DeadLockDemo$$Lambda$1&#x2F;972765878.run(Unknown Source)</span><br><span class="line">        at java.lang.Thread.run(Thread.java:748)</span><br><span class="line"></span><br><span class="line">Found 1 deadlock.</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>可以看到 <code>jstack</code> 命令已经帮我们找到发生死锁的线程的具体信息。</p>
<h2 id="6-jinfo"><a class="markdownIt-Anchor" href="#6-jinfo"></a> 6. jinfo</h2>
<p>jinfo(JVM Configuration info)这个命令作用是实时查看和调整虚拟机运行参数。 之前的jps -v口令只能查看到显示指定的参数，如果想要查看未被显示指定的参数的值就要使用jinfo口令</p>
<h3 id="命令帮助-6"><a class="markdownIt-Anchor" href="#命令帮助-6"></a> 命令帮助</h3>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2ze2e5wmatyx36v5jw5lz ~]# jinfo -help</span><br><span class="line">Usage:</span><br><span class="line">    jinfo [option] &lt;pid&gt;</span><br><span class="line">        (to connect to running process)</span><br><span class="line">    jinfo [option] &lt;executable &lt;core&gt;</span><br><span class="line">        (to connect to a core file)</span><br><span class="line">    jinfo [option] [server_id@]&lt;remote server IP or hostname&gt;</span><br><span class="line">        (to connect to remote debug server)</span><br><span class="line"></span><br><span class="line">where &lt;option&gt; is one of:</span><br><span class="line">    -flag &lt;name&gt;         to print the value of the named VM flag</span><br><span class="line">    -flag [+|-]&lt;name&gt;    to enable or disable the named VM flag</span><br><span class="line">    -flag &lt;name&gt;=&lt;value&gt; to set the named VM flag to the given value</span><br><span class="line">    -flags               to print VM flags</span><br><span class="line">    -sysprops            to print Java system properties</span><br><span class="line">    &lt;no option&gt;          to print both of the above</span><br><span class="line">    -h | -help           to print this help message</span><br></pre></td></tr></table></figure>
<h3 id="参数详解-3"><a class="markdownIt-Anchor" href="#参数详解-3"></a> 参数详解</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-flag : 输出指定args参数的值</span><br><span class="line">-flags : 不需要args参数，输出所有JVM参数的值</span><br><span class="line">-sysprops : 输出系统属性，等同于System.getProperties()</span><br></pre></td></tr></table></figure>
<h3 id="示例详情-2"><a class="markdownIt-Anchor" href="#示例详情-2"></a> 示例详情</h3>
<h4 id="-flags"><a class="markdownIt-Anchor" href="#-flags"></a> -flags</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2ze2e5wmatyx36v5jw5lz ~]# jinfo -flags 1701</span><br><span class="line">Attaching to process ID 1701, please wait...</span><br><span class="line">Debugger attached successfully.</span><br><span class="line">Server compiler detected.</span><br><span class="line">JVM version is 25.201-b09</span><br><span class="line">Non-default VM flags: -XX:CICompilerCount=2 -XX:InitialHeapSize=31457280 -XX:MaxHeapSize=482344960 -XX:MaxNewSize=160759808 -XX:MinHeapDeltaBytes=196608 -XX:NewSize=10485760 -XX:OldSize=20971520 -XX:+UseCompressedClassPointers -XX:+UseCompressedOops</span><br><span class="line">Command line:</span><br></pre></td></tr></table></figure>
<h4 id="-flag"><a class="markdownIt-Anchor" href="#-flag"></a> -flag</h4>
<p><code>jinfo -flag name vmid</code> :输出对应名称的参数的具体值。比如输出 MaxHeapSize、查看当前 jvm 进程是否开启打印 GC 日志 ( <code>-XX:PrintGCDetails</code> :详细 GC 日志模式，这两个都是默认关闭的)。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2ze2e5wmatyx36v5jw5lz ~]# jinfo -flag MaxHeapSize 1701</span><br><span class="line">-XX:MaxHeapSize=482344960</span><br><span class="line">[root@iz2ze2e5wmatyx36v5jw5lz ~]# jinfo -flag PrintGC 1701</span><br><span class="line">-XX:-PrintGC</span><br></pre></td></tr></table></figure>
<p>使用 jinfo 可以在不重启虚拟机的情况下，可以动态的修改 jvm 的参数。尤其在线上的环境特别有用。**</p>
<p><strong><code>jinfo -flag [+|-]name vmid</code> 开启或者关闭对应名称的参数。</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2ze2e5wmatyx36v5jw5lz ~]# jinfo -flag PrintGC 1701</span><br><span class="line">-XX:-PrintGC</span><br><span class="line">[root@iz2ze2e5wmatyx36v5jw5lz ~]# jinfo -flag +PrintGC 1701</span><br><span class="line">[root@iz2ze2e5wmatyx36v5jw5lz ~]# jinfo -flag PrintGC 1701</span><br><span class="line">-XX:+PrintGC</span><br></pre></td></tr></table></figure>
<h2 id="jvm查看运行时参数"><a class="markdownIt-Anchor" href="#jvm查看运行时参数"></a> JVM查看运行时参数</h2>
<p><strong>打印命令行参数</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2ze2e5wmatyx36v5jw5lz ~]# java -XX:+PrintCommandLineFlags -version</span><br><span class="line">-XX:InitialHeapSize=30115776 -XX:MaxHeapSize=481852416 -XX:+PrintCommandLineFlags -XX:+UseCompressedClassPointers -XX:+UseCompressedOops</span><br><span class="line">java version &quot;1.8.0_201&quot;</span><br><span class="line">Java(TM) SE Runtime Environment (build 1.8.0_201-b09)</span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM (build 25.201-b09, mixed mode)</span><br></pre></td></tr></table></figure>
<p><strong>打印初始参数</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -XX:+PrintFlagsInitial -version</span><br></pre></td></tr></table></figure>
<p><strong>查看最终值</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -XX:+PrintFlagsFinal -version</span><br></pre></td></tr></table></figure>
<h2 id="生成dump文件"><a class="markdownIt-Anchor" href="#生成dump文件"></a> 生成dump文件</h2>
<ol>
<li>
<p>JVM的配置文件中配置：</p>
<p>例如：堆初始化大小，而堆最大大小</p>
<p>在应用启动时配置相关的参数 -XX:+HeapDumpOnOutOfMemoryError，当应用抛出OutOfMemoryError时生成dump文件。</p>
<p>在启动的时候，配置文件在哪个目录下面：</p>
</li>
</ol>
<p>-XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=目录+产生的时间.hprof</p>
<p>JVM启动时增加两个参数:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#出现 OOME 时生成堆 dump:</span><br><span class="line">-XX:+HeapDumpOnOutOfMemoryError</span><br><span class="line"></span><br><span class="line">#生成堆文件地址：</span><br><span class="line">-XX:HeapDumpPath&#x3D;&#x2F;home&#x2F;liuke&#x2F;jvmlogs&#x2F;</span><br></pre></td></tr></table></figure>
<ol>
<li>
<p>发现程序异常前通过执行指令，直接生成当前JVM的dmp文件，6214是指JVM的进程号</p>
<p>jmap -dump:file=文件名.dump [pid]</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jmap -dump:format&#x3D;b,file&#x3D;serviceDump.dat 6214</span><br></pre></td></tr></table></figure>
<p>由于第一种方式是一种事后方式，需要等待当前JVM出现问题后才能生成dmp文件，实时性不高，第二种方式在执行时，JVM是暂停服务的，所以对线上的运行会产生影响。所以建议第一种方式。</p>
<h2 id="生产级jvm参数配置"><a class="markdownIt-Anchor" href="#生产级jvm参数配置"></a> 生产级JVM参数配置</h2>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;4核心8G内存配置 </span><br><span class="line">-Xms4g </span><br><span class="line">-Xmx4g </span><br><span class="line">-Xmn2g </span><br><span class="line">-XX:MetaspaceSize&#x3D;256M </span><br><span class="line">-XX:MaxMetaspaceSize&#x3D;256M </span><br><span class="line">-XX:ReservedCodeCacheSize&#x3D;256M</span><br><span class="line">-XX:MaxDirectMemorySize&#x3D;1g </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F;8核16G内存配置</span><br><span class="line">-Xms10g </span><br><span class="line">-Xmx10g </span><br><span class="line">-Xmn6g </span><br><span class="line">-XX:MetaspaceSize&#x3D;512M </span><br><span class="line">-XX:MaxMetaspaceSize&#x3D;512M </span><br><span class="line">-XX:ReservedCodeCacheSize&#x3D;512M</span><br><span class="line">-XX:MaxDirectMemorySize&#x3D;1g </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; Tuning JVM  for Production Deployments</span><br><span class="line">&#x2F;&#x2F; &gt; java8</span><br><span class="line">&#x2F;&#x2F; 生产环境推荐</span><br><span class="line">-server </span><br><span class="line">-Xms24G</span><br><span class="line">-Xmx24G</span><br><span class="line">-XX:PermSize&#x3D;512m</span><br><span class="line">-XX:+UseG1GC </span><br><span class="line">-XX:MaxGCPauseMillis&#x3D;200 </span><br><span class="line">-XX:ParallelGCThreads&#x3D;20 </span><br><span class="line">-XX:ConcGCThreads&#x3D;5 </span><br><span class="line">-XX:InitiatingHeapOccupancyPercent&#x3D;70</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 从服务器推荐</span><br><span class="line">-server </span><br><span class="line">-Xms4G </span><br><span class="line">-Xmx4G </span><br><span class="line">-XX:PermSize&#x3D;512m </span><br><span class="line">-XX:+UseG1GC </span><br><span class="line">-XX:MaxGCPauseMillis&#x3D;200 </span><br><span class="line">-XX:ParallelGCThreads&#x3D;20 </span><br><span class="line">-XX:ConcGCThreads&#x3D;5 </span><br><span class="line">-XX:InitiatingHeapOccupancyPercent&#x3D;70</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 独立服务器</span><br><span class="line">-server </span><br><span class="line">-Xms32G </span><br><span class="line">-Xmx32G </span><br><span class="line">-XX:PermSize&#x3D;512m </span><br><span class="line">-XX:+UseG1GC </span><br><span class="line">-XX:MaxGCPauseMillis&#x3D;200 </span><br><span class="line">-XX:ParallelGCThreads&#x3D;20 </span><br><span class="line">-XX:ConcGCThreads&#x3D;5 </span><br><span class="line">-XX:InitiatingHeapOccupancyPercent&#x3D;70</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; http:&#x2F;&#x2F;www.51gjie.com&#x2F;java&#x2F;551.html</span><br><span class="line">&#x2F;&#x2F; https:&#x2F;&#x2F;www.cnblogs.com&#x2F;gxyandwmm&#x2F;p&#x2F;9456955.html</span><br><span class="line">&#x2F;&#x2F; For JDK 1.7⁄ 1.8 (8GB heap example for machine with 32 CPUs):</span><br><span class="line">-server &#x2F;&#x2F; 服务器模式</span><br><span class="line">-Xms8g &#x2F;&#x2F; JVM初始分配的堆内存，一般和Xmx配置成一样以避免每次gc后JVM重新分配内存</span><br><span class="line">-Xmx8g &#x2F;&#x2F; JVM最大允许分配的堆内存，按需分配</span><br><span class="line">-XX:+UseParNewGC &#x2F;&#x2F; 年轻代垃圾收集器</span><br><span class="line">-XX:+UseConcMarkSweepGC &#x2F;&#x2F; 并发标记清除（CMS）收集器 (年老代)</span><br><span class="line">-XX:+UseTLAB </span><br><span class="line">-XX:NewSize&#x3D;128m &#x2F;&#x2F; 年轻代大小</span><br><span class="line">-XX:MaxNewSize&#x3D;128m &#x2F;&#x2F; 最大年轻代大小</span><br><span class="line">-XX:MaxTenuringThreshold&#x3D;2 &#x2F;&#x2F; 提升年老代的最大临界值,JDK8里CMS 默认是6，其他如G1是15</span><br><span class="line">-XX:SurvivorRatio&#x3D;8  &#x2F;&#x2F; Eden区与Survivor区的大小比值</span><br><span class="line">-XX:+UseCMSInitiatingOccupancyOnly  &#x2F;&#x2F;使用手动定义初始化定义开始CMS收集</span><br><span class="line">-XX:CMSInitiatingOccupancyFraction&#x3D;40 &#x2F;&#x2F;使用cms作为垃圾回收使用40％后开始CMS收集</span><br><span class="line">-XX:MaxGCPauseMillis&#x3D;1000 &#x2F;&#x2F; 用户设定的最大gc 停顿时间1000ms</span><br><span class="line">-XX:InitiatingHeapOccupancyPercent&#x3D;50 &#x2F;&#x2F; heap中50%的容量被使用，则会触发concurrent gc</span><br><span class="line">-XX:+UseCompressedOops</span><br><span class="line">-XX:ParallelGCThreads&#x3D;8 &#x2F;&#x2F; 设置垃圾收集器在并行阶段使用的线程数,默认值随JVM运行的平台不同而不同.</span><br><span class="line">-XX:ConcGCThreads&#x3D;8 </span><br><span class="line">-XX:+DisableExplicitGC &#x2F;&#x2F; 忽略手动调用GC, System.gc()的调用就会变成一个空调用，完全不触发GC</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="jvm参数设置优化例子"><a class="markdownIt-Anchor" href="#jvm参数设置优化例子"></a> JVM参数设置优化例子</h2>
<p><strong>1. 承受海量访问的动态Web应用</strong></p>
<p>服务器配置：8 CPU, 8G MEM, JDK 1.6.X<br />
参数方案：<br />
-server -Xmx3550m -Xms3550m -Xmn1256m -Xss128k -XX:SurvivorRatio=6 -XX:MaxPermSize=256m -XX:ParallelGCThreads=8 -XX:MaxTenuringThreshold=0 -XX:+UseConcMarkSweepGC<br />
调优说明：<br />
-Xmx 与 -Xms 相同以避免JVM反复重新申请内存。-Xmx 的大小约等于系统内存大小的一半，即充分利用系统资源，又给予系统安全运行的空间。<br />
-Xmn1256m 设置年轻代大小为1256MB。此值对系统性能影响较大，Sun官方推荐配置年轻代大小为整个堆的3/8。<br />
-Xss128k 设置较小的线程栈以支持创建更多的线程，支持海量访问，并提升系统性能。<br />
-XX:SurvivorRatio=6 设置年轻代中Eden区与Survivor区的比值。系统默认是8，根据经验设置为6，则2个Survivor区与1个Eden区的比值为2:6，一个Survivor区占整个年轻代的1/8。<br />
-XX:ParallelGCThreads=8 配置并行收集器的线程数，即同时8个线程一起进行垃圾回收。此值一般配置为与CPU数目相等。<br />
-XX:MaxTenuringThreshold=0 设置垃圾最大年龄（在年轻代的存活次数）。如果设置为0的话，则年轻代对象不经过Survivor区直接进入年老代。对于年老代比较多的应用，可以提高效率；如果将此值设置为一个较大值，则年轻代对象会在Survivor区进行多次复制，这样可以增加对象再年轻代的存活时间，增加在年轻代即被回收的概率。根据被海量访问的动态Web应用之特点，其内存要么被缓存起来以减少直接访问DB，要么被快速回收以支持高并发海量请求，因此其内存对象在年轻代存活多次意义不大，可以直接进入年老代，根据实际应用效果，在这里设置此值为0。<br />
-XX:+UseConcMarkSweepGC 设置年老代为并发收集。CMS（ConcMarkSweepGC）收集的目标是尽量减少应用的暂停时间，减少Full GC发生的几率，利用和应用程序线程并发的垃圾回收线程来标记清除年老代内存，适用于应用中存在比较多的长生命周期对象的情况。</p>
<p><strong>2. 内部集成构建服务器案例</strong></p>
<p>高性能数据处理的工具应用<br />
服务器配置：1 CPU, 4G MEM, JDK 1.6.X<br />
参数方案：<br />
-server -XX:PermSize=196m -XX:MaxPermSize=196m -Xmn320m -Xms768m -Xmx1024m<br />
调优说明：<br />
-XX:PermSize=196m -XX:MaxPermSize=196m 根据集成构建的特点，大规模的系统编译可能需要加载大量的Java类到内存中，所以预先分配好大量的持久代内存是高效和必要的。<br />
-Xmn320m 遵循年轻代大小为整个堆的3/8原则。<br />
-Xms768m -Xmx1024m 根据系统大致能够承受的堆内存大小设置即可。</p>
<h1 id="最后"><a class="markdownIt-Anchor" href="#最后"></a> 最后</h1>
<p>本文到此结束，感谢阅读。如果您觉得不错，请关注公众号【当我遇上你】，您的支持是我写作的最大动力。</p>
<h1 id="参考"><a class="markdownIt-Anchor" href="#参考"></a> 参考</h1>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.javatang.com/archives/2017/10/19/33151873.html">https://www.javatang.com/archives/2017/10/19/33151873.html</a></li>
</ul>

      
    </div>
    <div class="article-footer">
      <!--<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-6442249173079218"
     data-ad-slot="9150075714"></ins>
<script>
    (adsbygoogle = window.adsbygoogle || []).push({});
</script>
-->
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="https://idea360.cn/2021/08/05/jvm-tuning-cmd/" title="JVM调优指令" target="_blank" rel="external">https://idea360.cn/2021/08/05/jvm-tuning-cmd/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="https://github.com/qidian360" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="https://gitee.com/idea360/oss/raw/master/images/one.png" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="https://github.com/qidian360" target="_blank"><span class="text-dark">当我遇上你</span><small class="ml-1x"></small></a></h3>
        <div>勿在浮沙筑高楼</div>
      </div>
    </figure>
  </div>
</div>


    </div>
  </article>
  
    
  <section id="comments">
  	
      <div id="vcomments"></div>
    
  </section>


  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/2021/08/05/jvm-tuning-online/" title="JVM线上调优"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a>
    </li>
    
    
    <li class="next">
      <a href="/2021/08/05/jvm-gc/" title="JVM垃圾回收"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
    <li class="toggle-toc">
      <a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button">
        <span>[&nbsp;</span><span>文章目录</span>
        <i class="text-collapsed icon icon-anchor"></i>
        <i class="text-in icon icon-close"></i>
        <span>]</span>
      </a>
    </li>
    
  </ul>
  
  
  <!-- Button trigger modal -->
  <button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button>
  <!-- <div class="wave-icon wave-icon-danger btn-donate" data-toggle="modal" data-target="#donateModal">
    <div class="wave-circle"><span class="icon"><i class="icon icon-bill"></i></span></div>
  </div> -->
  
  
  <div class="bar-right">
    
    <div class="share-component" data-sites="wechat" data-mobile-sites="wechat"></div>
    
  </div>
  </div>
</nav>
  
<!-- Modal -->
<div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content donate">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <div class="modal-body">
        <div class="donate-box">
          <div class="donate-head">
            <p>感谢您的支持，我会继续努力的!</p>
          </div>
          <div class="tab-content">
            <div role="tabpanel" class="tab-pane fade active in" id="alipay">
              <div class="donate-payimg">
                <img src="https://gitee.com/idea360/oss/raw/master/images/zfbsk.JPG" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">扫码打赏，你说多少就多少</p>
              <p class="text-grey">打开支付宝扫一扫，即可进行扫码打赏哦</p>
            </div>
            <div role="tabpanel" class="tab-pane fade" id="wechatpay">
              <div class="donate-payimg">
                <img src="https://gitee.com/idea360/oss/raw/master/images/wxsk.JPG" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">扫码打赏，你说多少就多少</p>
              <p class="text-grey">打开微信扫一扫，即可进行扫码打赏哦</p>
            </div>
          </div>
          <div class="donate-footer">
            <ul class="nav nav-tabs nav-justified" role="tablist">
              <li role="presentation" class="active">
                <a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="true"><i class="icon icon-alipay"></i> 支付宝</a>
              </li>
              <li role="presentation" class="">
                <a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="false"><i class="icon icon-wepay"></i> 微信支付</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>




</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/qidian360" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="/atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
        &copy; 2021 当我遇上你
        
        <div class="publishby">
        	Theme by <a href="https://github.com/cofess" target="_blank"> cofess </a>base on <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a>.
        </div>
    </div>
</footer>
  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>


<script src="/js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>






   
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





   
    
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/valine"></script>
  <script type="text/javascript">
  var GUEST = ['nick', 'mail', 'link'];
  var meta = 'nick,mail,link';
  meta = meta.split(',').filter(function(item) {
    return GUEST.indexOf(item) > -1;
  });
  new Valine({
    el: '#vcomments',
    verify: false,
    notify: false,
    appId: 'nPtA4r7LjqdHMXOW4Gs9yQz0',
    appKey: 'UUYHyTz9su4cY3J1XDKWlxIH',
    placeholder: 'Just go go',
    avatar: 'mm',
    meta: meta,
    pageSize: '10' || 10,
    visitor: true
  });
  </script>

     







</body>
</html>